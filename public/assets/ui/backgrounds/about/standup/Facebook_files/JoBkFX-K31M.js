;/*FB_PKG_DELIM*/

__d("EBBridgedAPI",["IEBAPI"],(function(a,b,c,d,e,f,g){"use strict";b={getContactEpochHead:(a=d("IEBAPI")).makeBridgedApi("getContactEpochHead"),getMessageKeys:a.makeBridgedApi("getMessageKeys"),isEbEnabledEbSwitch:a.makeBridgedApi("isEbEnabledEbSwitch"),messageBulkPointQuery:a.makeBridgedApi("messageBulkPointQuery"),messageRangeQueryForIndexing:a.makeBridgedApi("messageRangeQueryForIndexing")};c=b;g["default"]=c}),98);
__d("FDSPhotoDownloadFilled16Icon",["cr:15408"],(function(a,b,c,d,e,f,g){"use strict";g["default"]=b("cr:15408")}),98);
__d("FDSPhotoDownloadFilled16PNGIcon.react",["ix","fbicon"],(function(a,b,c,d,e,f,g,h){"use strict";a=d("fbicon")._(h("1873235"),16);b=a;g["default"]=b}),98);
__d("LSIssueAttachmentsRangeQuery",["LSGetCursor","LSIssueNewTask"],(function(a,b,c,d,e,f){function a(){var a=arguments,c=a[a.length-1],d=[],e=[];return c.sequence([function(e){return c.sequence([function(b){return c.db.table(9).fetch([[[a[0]]]]).next().then(function(a,b){var e=a.done;a=a.value;return e?d[0]=c.i64.cast([0,1]):(b=a.item,d[5]=b.syncGroup,c.i64.neq(d[5],void 0)?d[4]=d[5]:d[4]=c.i64.cast([0,1]),d[0]=d[4])})},function(a){return c.storedProcedure(b("LSGetCursor"),d[0]).then(function(a){return a=a,d[2]=a[0],a})},function(e){return c.db.table(17).fetch([[[a[0],a[1]]]]).next().then(function(e,f){var g=e.done;e=e.value;return g?c.sequence([function(b){return c.db.table(9).fetch([[[a[0]]]]).next().then(function(b,e){var a=b.done;b=b.value;return a?d[4]=c.i64.cast([0,1]):(e=b.item,d[9]=e.syncGroup,c.i64.neq(d[9],void 0)?d[8]=d[9]:d[8]=c.i64.cast([0,1]),d[4]=d[8])})},function(e){return d[6]=new c.Map(),d[6].set("thread_key",a[0]),d[6].set("media_group",a[1]),d[6].set("max_timestamp_ms",c.i64.cast([2328,1316134911])),d[6].set("cursor",d[2]),d[6].set("sync_group",d[4]),d[6].set("last_loaded_message_id",void 0),d[7]=c.toJSON(d[6]),c.storedProcedure(b("LSIssueNewTask"),"arq",c.i64.cast([0,105]),d[7],void 0,void 0,c.i64.cast([0,0]),c.i64.cast([0,0]),void 0,void 0,c.i64.cast([0,0]),c.i64.cast([0,0]))}]):(f=e.item,f.hasMoreBefore?c.sequence([function(b){return c.db.table(9).fetch([[[a[0]]]]).next().then(function(b,e){var a=b.done;b=b.value;return a?d[4]=c.i64.cast([0,1]):(e=b.item,d[9]=e.syncGroup,c.i64.neq(d[9],void 0)?d[8]=d[9]:d[8]=c.i64.cast([0,1]),d[4]=d[8])})},function(e){return d[6]=new c.Map(),d[6].set("thread_key",a[0]),d[6].set("media_group",a[1]),d[6].set("max_timestamp_ms",f.minTimestampMs),d[6].set("cursor",d[2]),d[6].set("sync_group",d[4]),d[6].set("last_loaded_message_id",void 0),d[7]=c.toJSON(d[6]),c.storedProcedure(b("LSIssueNewTask"),"arq",c.i64.cast([0,105]),d[7],void 0,void 0,c.i64.cast([0,0]),c.i64.cast([0,0]),void 0,void 0,c.i64.cast([0,0]),c.i64.cast([0,0]))}]):c.resolve())})}])},function(a){return c.resolve(e)}])}a.__sproc_name__="LSMailboxIssueAttachmentsRangeQueryStoredProcedure";a.__tables__=["threads","attachments_ranges_v2__generated"];e.exports=a}),null);
__d("LSIssueAttachmentsRangeQueryStoredProcedure",["LSIssueAttachmentsRangeQuery","LSSynchronousPromise","Promise","cr:8709"],(function(a,b,c,d,e,f,g){var h;function a(a,e){a=a.storedProcedure(c("LSIssueAttachmentsRangeQuery"),e.threadKey,e.mediaGroup);return(h||(h=b("Promise"))).resolve(d("LSSynchronousPromise").maybeExtractValueIfSynchronousPromise(a))}g["default"]=a}),98);
__d("MAWFetchAndPersistMedia",["CurrentUser","EBAPI","EBBridgedAPI","EchoMessage","EchoMessageMediaFieldUtils","I64","LSDatabaseSingleton","LSIntEnum","LSMEBTaskCreationSource","MAWHandleEchoProtobufsRestoreApi","MAWJids","MAWJobDefinitions","MAWMediaRestoreEBRange","MAWMsgType","MAWRestoreMessagesFromEncryptedBackupsDeferred","MAWRestoreProtobufsFromEncryptedBackupsDeferred","ReQL","WAJids","WALogger","WAResultOrError","gkx","justknobx"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j,k,l;b=c("justknobx")._("3177");var m=c("justknobx")._("2538"),n=c("justknobx")._("3916"),o="timeout",p=b;function a(a,b,c,e){var f=d("MAWMediaRestoreEBRange").getMediaRestoreEBRange(),g=f.getRange(b),h=d("WAJids").threadIdForChatJid(a);if(g.hasMoreBefore===!1)return Promise.resolve();e==null||e.addPoint("eb_fetch_and_persist_start",{int:{mediaGalleryGroup:c}});return u({jid:a,nextTimestampMsBefore:g.nextTimestampMsBefore,numMessages:p,threadId:h}).then(function(a){var g=a.error;g!=null&&(e==null||e.addPoint("eb_fetch_and_persist_error",{string:{error:g}}));if(g!==o){f.updateRange(b,{hasMoreBefore:(g=a==null?void 0:a.hasMoreBefore)!=null?g:!1,nextTimestampMsBefore:(j||(j=d("I64"))).to_string((g=a==null?void 0:a.nextMessageTimestampMsBefore)!=null?g:(j||(j=d("I64"))).zero)})}return q(a,h).then(function(){e==null||e.addPoint("eb_fetch_and_persist_end");return t(b,c,{hasMoreBefore:!0})})})}function q(a,b){if(a.success===!1)return Promise.resolve();if(a.echoMessages!=null&&a.echoMessages.length>0)return r(a,b);return a.protobufMessages!=null&&a.protobufMessages.length>0?s(a,b):Promise.resolve()}function r(a,b){var e;e=(e=a==null?void 0:a.echoMessages)!=null?e:[];var f=[d("EchoMessageMediaFieldUtils").AttachmentType.IMAGE,d("EchoMessageMediaFieldUtils").AttachmentType.VIDEO],g=e.filter(function(a){var b;a=d("EchoMessage").decodeEchoMessage(a);return(a==null?void 0:a.contentType)===d("EchoMessage").EchoMessageContentType.MEDIA&&f.includes(a==null||(b=a.mediaData)==null?void 0:b.attachmentType)});e.length!==g.length&&(p=m);return d("MAWRestoreMessagesFromEncryptedBackupsDeferred").call("AdvancedCrypto",d("MAWJobDefinitions").toThreadJidPrimaryId(b),g,(e=a==null?void 0:a.hasMoreBefore)!=null?e:!1,void 0,(b=a==null?void 0:a.hasMoreAfter)!=null?b:!1,void 0,(g=a==null?void 0:a.isPointQuery)!=null?g:!1,a==null?void 0:a.requestId,a==null?void 0:a.referenceTimestamp,c("LSMEBTaskCreationSource").MEDIA_GALLERY_RESTORE).catch(function(a){d("WALogger").ERROR(h||(h=babelHelpers.taggedTemplateLiteralLoose(["MediaPersist Echo error: ",""])),a)})}function s(a,b){var e,f=d("MAWJids").toUserJid(c("CurrentUser").getAccountID());e=(e=a==null?void 0:a.protobufMessages)!=null?e:[];var g=[d("MAWMsgType").MSG_TYPE.IMAGE,d("MAWMsgType").MSG_TYPE.VIDEO],h=e.filter(function(a){a=d("MAWHandleEchoProtobufsRestoreApi").decodeDecryptedMessageProtobuf(a,f,void 0,new Set(),new Set(),new Map(),new Map(),new Map(),!0);return g.includes(a.msgType)});e.length!==h.length&&(p=m);return d("MAWRestoreProtobufsFromEncryptedBackupsDeferred").call("AdvancedCrypto",d("MAWJobDefinitions").toThreadJidPrimaryId(b),h,(e=a==null?void 0:a.hasMoreBefore)!=null?e:!1,void 0,(b=a==null?void 0:a.hasMoreAfter)!=null?b:!1,void 0,(h=a==null?void 0:a.isPointQuery)!=null?h:!1,a==null?void 0:a.requestId,a==null?void 0:a.referenceTimestamp,void 0,void 0,(j||(j=d("I64"))).of_int32(c("LSMEBTaskCreationSource").MEDIA_GALLERY_RESTORE)).catch(function(a){d("WALogger").ERROR(i||(i=babelHelpers.taggedTemplateLiteralLoose(["MediaPersist Protobuf error: ",""])),a)})}async function t(a,b,c){var e=await (k||(k=d("LSDatabaseSingleton"))).LSDatabaseSingleton;return e.runInTransaction(async function(f){var g=await d("ReQL").firstAsync(d("ReQL").fromTableAscending(e.tables.attachments_ranges_v2__generated).getKeyRange(a).filter(function(a){return(j||(j=d("I64"))).equal(a.mediaGroup,(l||(l=d("LSIntEnum"))).ofNumber(b))}));if(g==null)return;var h=babelHelpers.extends({},g,c);return f.attachments_ranges_v2__generated.upsert([g.threadKey,g.mediaGroup,g.minTimestampMs],h)},"readwrite","ui",void 0,f.id+":226")}async function u(a){var b,e=a.jid,f=a.nextTimestampMsBefore,g=a.numMessages;a=a.threadId;f=c("gkx")("5431")?c("EBBridgedAPI").messageRangeQueryForIndexing({chatJid:e,direction:"before",numMessages:g,sortOrderMs:f,source:c("LSMEBTaskCreationSource").MEDIA_GALLERY_RESTORE}):c("EBAPI").messageRangeQueryForIndexing({chatJid:e,direction:"before",numMessages:g,sortOrderMs:f,source:c("LSMEBTaskCreationSource").MEDIA_GALLERY_RESTORE});var h=null;f=await Promise.race([f,new Promise(function(a){h=window.setTimeout(function(){return a(d("WAResultOrError").makeError(o))},n)})]);window.clearTimeout(h);if(f.success===!1)return f;f=f.value;b=(j||(j=d("I64"))).to_string((b=f==null?void 0:f.nextMessageTimestampMsBefore)!=null?b:(j||(j=d("I64"))).zero);return(f==null?void 0:f.referenceTimestamp)===b?g===m?d("WAResultOrError").makeError("Retried with max pageSize: "+m+". Still stuck"):u({jid:e,nextTimestampMsBefore:b,numMessages:m,threadId:a}):f}g.MAWFetchAndPersistMedia=a;g.updateLocalAttachmentsRange=t}),98);
__d("MDSShareSvgIcon.react",["MDSSvgIcon.react","react","react-compiler-runtime"],(function(a,b,c,d,e,f,g){"use strict";var h,i=h||d("react");function a(a){var b=d("react-compiler-runtime").c(4),e,f;b[0]===Symbol["for"]("react.memo_cache_sentinel")?(e=i.jsx("path",{d:"M18.766 4.857a1 1 0 00-1.532 0L13.878 8.86a1 1 0 00.766 1.643H16.5a.25.25 0 01.25.25v10.75a1 1 0 001 1h.5a1 1 0 001-1v-10.75a.25.25 0 01.25-.25h1.856a1 1 0 00.766-1.643l-3.356-4.002z"}),f=i.jsx("path",{d:"M14.75 13.502a1 1 0 00-1-1H12.5a4 4 0 00-4 4v8.5a4 4 0 004 4h11a4 4 0 004-4v-8.5a4 4 0 00-4-4h-1.25a1 1 0 00-1 1v.5a1 1 0 001 1h1.25a1.5 1.5 0 011.5 1.5v8.5a1.5 1.5 0 01-1.5 1.5h-11a1.5 1.5 0 01-1.5-1.5v-8.5a1.5 1.5 0 011.5-1.5h1.25a1 1 0 001-1v-.5z"}),b[0]=e,b[1]=f):(e=b[0],f=b[1]);b[2]!==a?(e=i.jsxs(c("MDSSvgIcon.react"),babelHelpers["extends"]({},a,{children:[e,f]})),b[2]=a,b[3]=e):e=b[3];return e}g["default"]=a}),98);
__d("useMAWBulkMaybeAutoTriggerDownload",["MAWDownloadMediaInWorkerDeferred","MAWMediaDownloadStatus","MAWMediaManagerUiIntegrationCheck","justknobx","react","react-compiler-runtime","useAsyncReStore","useMAWBulkMediaDownloadStatus"],(function(a,b,c,d,e,f,g){"use strict";var h;b=h||d("react");var i=b.useEffect;b.useMemo;var j=b.useRef;function a(a,b,e){var f=d("react-compiler-runtime").c(14),g=c("useMAWBulkMediaDownloadStatus")(a),h;f[0]===Symbol["for"]("react.memo_cache_sentinel")?(h=[c("MAWMediaDownloadStatus").MISSING_FILE,c("MAWMediaDownloadStatus").MANUAL_RETRYABLE_FAILURE,c("MAWMediaDownloadStatus").DOWNLOADING].filter(Boolean),f[0]=h):h=f[0];var k=h;if(f[1]!==g||f[2]!==e){f[4]!==e?(h=function(a){var b,c,f=(!d("MAWMediaManagerUiIntegrationCheck").getIsMediaManagerUiIntegrationEnabled()||e==null||e==="fullsize"||e==="fullsizeAndPreview")&&k.includes(a==null||(b=a.status)==null?void 0:b.mainMediaStatus),g=d("MAWMediaManagerUiIntegrationCheck").getIsMediaManagerUiIntegrationEnabled()&&e==="preview"&&k.includes(a==null||(c=a.status)==null?void 0:c.previewMediaStatus);g=g||f;return[a.attachment.attachmentFbid,g]},f[4]=e,f[5]=h):h=f[5];h=new Map(g.map(h));f[1]=g;f[2]=e;f[3]=h}else h=f[3];g=h;var l=g;f[6]===Symbol["for"]("react.memo_cache_sentinel")?(h=new Map(),f[6]=h):h=f[6];var m=j(h),n=c("useAsyncReStore")();f[7]!==a||f[8]!==n||f[9]!==e||f[10]!==l||f[11]!==b?(g=function(){var f=[];a.forEach(function(a){var g,h,i=a.attachment;a=a.mediaRenderQpl;g=(g=l.get(i.attachmentFbid))!=null?g:!1;h=(h=m.current.get(i.attachmentFbid))!=null?h:!1;g&&!h&&(m.current.set(i.attachmentFbid,!0),!c("justknobx")._("3226")?d("MAWDownloadMediaInWorkerDeferred").maybeDownloadMediaInWorker({attachment:i,dbPromise:n,downloadType:e,mediaRenderQpl:a,triggerUIView:b}):f.push({attachment:i,mediaRenderQpl:a}))});f.length>0&&d("MAWDownloadMediaInWorkerDeferred").maybeBulkDownloadMediaInWorker({attachmentsWithQpl:f,dbPromise:n,downloadType:e,triggerUIView:b})},h=[a,n,e,m,l,b],f[7]=a,f[8]=n,f[9]=e,f[10]=l,f[11]=b,f[12]=g,f[13]=h):(g=f[12],h=f[13]);i(g,h)}g["default"]=a}),98);
__d("MWChatAttachmentMediaState.react",["$InternalEnum","I64","LSIntEnum","MAWClientMediaStatusUtils","MAWMediaManagerUiIntegrationCheck","MAWVideoAudioPlaybackErrorHandlerUtils","MessagingAttachmentType","RavenMessagingState","filterNulls","react","useClientMediaStatus","useMAWBulkMaybeAutoTriggerDownload","usePrevious"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j,k=h||(h=d("react"));e=h;var l=e.createContext,m=e.useEffect,n=e.useMemo,o=e.useState,p=b("$InternalEnum")({Image:0,Video:1}),q=l({canMoveBackward:!1,canMoveForward:!1,card:void 0,cards:[],currentIndex:0,moveBackward:function(){},moveForward:function(){},moveTo:function(){},numberOfCards:0,shouldTriggerLoadMore:!1});function r(a){var b=a.attachmentType;a=a.ephemeralMediaState;return a!=null&&(i||(i=d("I64"))).equal(b,(j||(j=d("LSIntEnum"))).ofNumber(c("MessagingAttachmentType").EPHEMERAL_IMAGE))&&(i||(i=d("I64"))).equal(a,(j||(j=d("LSIntEnum"))).ofNumber(c("RavenMessagingState").PERMANENT))}function s(a){var b=a.attachmentType;a=a.ephemeralMediaState;return a!=null&&(i||(i=d("I64"))).equal(b,(j||(j=d("LSIntEnum"))).ofNumber(c("MessagingAttachmentType").EPHEMERAL_VIDEO))&&(i||(i=d("I64"))).equal(a,(j||(j=d("LSIntEnum"))).ofNumber(c("RavenMessagingState").PERMANENT))}function t(a,b,c,d){return c?d.hasMedia:b(d,"isPlayableMedia")!=null&&a(d,"isPlayableMedia")!=null}function u(a,b,e,f){var g=f.attachmentType;return!t(a,b,e,f)?!1:r(f)||(i||(i=d("I64"))).equal(g,(j||(j=d("LSIntEnum"))).ofNumber(c("MessagingAttachmentType").IMAGE))}function v(a,b,e,f,g){var h=f.attachmentFbid,k=f.attachmentType,l=!1,m=!1;g=d("MAWClientMediaStatusUtils").getStatusDataFromLsdb({clientMediaStatus:g,statusKey:h});h=g.hasStatus;g=g.statusData;if(h){h=g!=null?g:{};g=h.validationResult;l=g!=null?d("MAWVideoAudioPlaybackErrorHandlerUtils").isInvalidVideo(f,g):!1;m=g!=null?d("MAWVideoAudioPlaybackErrorHandlerUtils").isUnsupportedVideo(f,g):!1}return!t(a,b,e,f)||l||m?!1:s(f)||(i||(i=d("I64"))).equal(k,(j||(j=d("LSIntEnum"))).ofNumber(c("MessagingAttachmentType").VIDEO))}function w(a,b){m(function(){a.forEach(function(a){try{a.attachment.hasMedia&&b(a.attachment,"usePreloadThumbnails");return}catch(a){return}})},[a,b])}function a(a){var b=a.attachments,e=a.children,f=a.getIsSecureThread,g=a.getPlayableUrl,h=a.getPreviewUrl;a=a.initialAttachment;a=o(a);var i=a[0],j=a[1];a=c("usePrevious")(i==null?void 0:i.messageId);var l=n(function(){return b.map(function(a){return{attachment:a,mediaRenderQpl:null,statusKey:a.attachmentFbid}})},[b]),m=c("useClientMediaStatus")(l),r=n(function(){return i!=null&&d("MAWMediaManagerUiIntegrationCheck").getIsMediaManagerUiIntegrationEnabled()?{attachment:i,mediaRenderQpl:null,statusKey:i.attachmentFbid}:null},[i]);c("useMAWBulkMaybeAutoTriggerDownload")(l,"fullsize","preview");c("useMAWBulkMaybeAutoTriggerDownload")(r!=null?[r]:[],"fullsize","fullsizeAndPreview");var s=n(function(){return c("filterNulls")(b.map(function(a){var b=f(a);if(u(g,h,b,a))return{attachment:a,type:p.Image};return v(g,h,b,a,m)?{attachment:a,type:p.Video}:null}))},[b,m,f,g,h]),t=i==null?-1:s.findIndex(function(a){return a.attachment.attachmentFbid===i.attachmentFbid&&a.attachment.messageId===i.messageId}),x=a!=null&&(i==null?void 0:i.messageId)!==a&&t>s.length-5;w(s,h);l=n(function(){var a=Math.max(0,s.length-1);return{canMoveBackward:t>0&&t!==-1,canMoveForward:t<a&&t!==-1,card:s[t],cards:s,currentIndex:t,moveBackward:function(){var a=Math.max(t-1,0);j((a=s[a])==null?void 0:a.attachment)},moveForward:function(){var b=Math.min(t+1,a);j((b=s[b])==null?void 0:b.attachment)},moveTo:function(a){j(a.attachment)},numberOfCards:s.length,shouldTriggerLoadMore:x}},[s,t,x]);return k.jsx(q.Provider,{value:l,children:e})}a.displayName=a.name+" [from "+f.id+"]";g.AttachmentMediaType=p;g.context=q;g.MWChatAttachmentMediaStateProviderFromAttachments=a}),98);
__d("MWChatAttachmentMediaNavigationHotkeys.react",["fbt","CometKeys","MWChatAttachmentMediaState.react","justknobx","react","react-compiler-runtime","useLayerKeyCommands"],(function(a,b,c,d,e,f,g,h){"use strict";var i,j=i||(i=d("react"));b=i;var k=b.useContext;b.useMemo;var l={key:c("CometKeys").LEFT},m={key:c("CometKeys").RIGHT},n={key:c("CometKeys").ESCAPE},o=h._(/*BTDS*/"\u0421\u043b\u0435\u0434\u0443\u044e\u0449\u0438\u0439 \u043e\u0431\u044a\u0435\u043a\u0442"),p=h._(/*BTDS*/"\u041f\u0440\u0435\u0434\u044b\u0434\u0443\u0449\u0438\u0439 \u043e\u0431\u044a\u0435\u043a\u0442"),q=h._(/*BTDS*/"\u0417\u0430\u043a\u0440\u044b\u0442\u044c");function a(a){var b=d("react-compiler-runtime").c(14),e=a.children;a=a.onClose;var f=k(d("MWChatAttachmentMediaState.react").context),g=f.moveBackward;f=f.moveForward;var h;b[0]!==g?(h={command:l,description:o,handler:g},b[0]=g,b[1]=h):h=b[1];b[2]!==f?(g={command:m,description:p,handler:f},b[2]=f,b[3]=g):g=b[3];b[4]!==a?(f=a!=null?{command:n,description:q,handler:a}:null,b[4]=a,b[5]=f):f=b[5];b[6]!==h||b[7]!==g||b[8]!==f?(a=[h,g,f],b[6]=h,b[7]=g,b[8]=f,b[9]=a):a=b[9];h=a;b[10]!==h?(g=h.filter(Boolean),b[10]=h,b[11]=g):g=b[11];f=g;a=f;c("useLayerKeyCommands")(a);b[12]!==e?(h=c("justknobx")._("3491")?j.jsx(j.Fragment,{children:e!=null?e:null}):j.jsx("div",{children:e!=null?e:null}),b[12]=e,b[13]=h):h=b[13];return h}g.keyLeft=l;g.keyRight=m;g.keyEscape=n;g.MWChatAttachmentMediaNavigationHotkeys=a}),226);
__d("MWV2MediaViewerContext.react",["react","react-compiler-runtime"],(function(a,b,c,d,e,f,g){"use strict";var h,i=h||(h=d("react"));h.useMemo;var j=i.createContext({getDownloadUrl:function(){},getPlayableUrl:function(){},getPreviewUrl:function(){},heroLoggingComponent:function(a){return null},loadMore:function(){},media:[]});function a(a){var b=d("react-compiler-runtime").c(10),c=a.children,e=a.getDownloadUrl,f=a.getPlayableUrl,g=a.getPreviewUrl,h=a.heroLoggingComponent,k=a.loadMore;a=a.media;var l;b[0]!==e||b[1]!==f||b[2]!==g||b[3]!==h||b[4]!==k||b[5]!==a?(l={getDownloadUrl:e,getPlayableUrl:f,getPreviewUrl:g,heroLoggingComponent:h,loadMore:k,media:a},b[0]=e,b[1]=f,b[2]=g,b[3]=h,b[4]=k,b[5]=a,b[6]=l):l=b[6];e=l;f=e;b[7]!==c||b[8]!==f?(g=i.jsx(j.Provider,{value:f,children:c}),b[7]=c,b[8]=f,b[9]=g):g=b[9];return g}g.context=j;g.MWV2MediaViewerContextProvider=a}),98);
__d("MWChatAttachmentMediaThumbnails.react",["CometMediaViewerFilmstrip.react","CometPlaceholder.react","MWChatAttachmentMediaState.react","MWV2MediaViewerContext.react","react","react-compiler-runtime"],(function(a,b,c,d,e,f,g){"use strict";var h,i=h||(h=d("react"));b=h;var j=b.useContext,k=b.useDeferredValue;function l(a){var b=a.card,c=a.getPlayableUrl;a=a.getPreviewUrl;var e=b.attachment,f,g="/images/comet/gray.png";if(e.hasMedia===!1)f=g;else{f=(a=a(e,"toFilmstripThumbnail"))!=null?a:g}a=f;b.type===d("MWChatAttachmentMediaState.react").AttachmentMediaType.Video&&!Boolean(f)&&(a=c(e,"toFilmstripThumbnail"));if(b.type===d("MWChatAttachmentMediaState.react").AttachmentMediaType.Image){return{alt:(g=e.accessibilitySummaryText)!=null?g:"",backgroundColor:void 0,height:0,isUseImageResizing:void 0,mediaType:"image",uri:f,width:0}}return{height:0,mediaType:"video",thumbnailUri:f,uri:a,width:0}}function m(a){var b,e,f=d("react-compiler-runtime").c(23),g=a.activeCard,h=a.cards,k=a.getPreviewUrl,m=a.onSetImage,n=j(d("MWV2MediaViewerContext.react").context);f[0]!==n?(a=function(a,b){return a==null?"":(a=n.getDownloadUrl(a,b))!=null?a:""},f[0]=n,f[1]=a):a=f[1];var o=a;if(f[2]!==h||f[3]!==o||f[4]!==k){f[6]!==o||f[7]!==k?(a=function(a){return l({card:a,getPlayableUrl:o,getPreviewUrl:k})},f[6]=o,f[7]=k,f[8]=a):a=f[8];a=h.map(a);f[2]=h;f[3]=o;f[4]=k;f[5]=a}else a=f[5];a=a;if(f[9]!==(g==null||(b=g.attachment)==null?void 0:b.attachmentFbid)||f[10]!==(g==null||(e=g.attachment)==null?void 0:e.messageId)||f[11]!==h){var p,q,r,s,t;if(f[13]!==(g==null||(p=g.attachment)==null?void 0:p.attachmentFbid)||f[14]!==(g==null||(q=g.attachment)==null?void 0:q.messageId)){var u,v;t=function(a){var b,c;return a.attachment.attachmentFbid===(g==null||(b=g.attachment)==null?void 0:b.attachmentFbid)&&a.attachment.messageId===(g==null||(c=g.attachment)==null?void 0:c.messageId)};f[13]=g==null||(u=g.attachment)==null?void 0:u.attachmentFbid;f[14]=g==null||(v=g.attachment)==null?void 0:v.messageId;f[15]=t}else t=f[15];t=h.findIndex(t);f[9]=g==null||(r=g.attachment)==null?void 0:r.attachmentFbid;f[10]=g==null||(s=g.attachment)==null?void 0:s.messageId;f[11]=h;f[12]=t}else t=f[12];t=t;var w;f[16]!==h||f[17]!==m?(w=function(a){return m(h[a])},f[16]=h,f[17]=m,f[18]=w):w=f[18];var x;f[19]!==t||f[20]!==a||f[21]!==w?(x=i.jsx(c("CometMediaViewerFilmstrip.react"),{activeIndex:t,images:a,onSetImage:w}),f[19]=t,f[20]=a,f[21]=w,f[22]=x):x=f[22];return x}function a(a){var b=d("react-compiler-runtime").c(6);a=a.getPreviewUrl;var e=j(d("MWChatAttachmentMediaState.react").context),f=e.card,g=e.cards;e=e.moveTo;g=k(g);var h;b[0]===Symbol["for"]("react.memo_cache_sentinel")?(h={className:"xdj266r x11t971q xat24cr xvc5jky x193iq5w x6ikm8r x10wlt62"},b[0]=h):h=b[0];b[1]!==f||b[2]!==g||b[3]!==a||b[4]!==e?(h=i.jsx("div",babelHelpers["extends"]({},h,{children:i.jsx(c("CometPlaceholder.react"),{fallback:null,name:"MWChatAttachmentMediaThumbnails",children:i.jsx(m,{activeCard:f,cards:g,getPreviewUrl:a,onSetImage:e})})})),b[1]=f,b[2]=g,b[3]=a,b[4]=e,b[5]=h):h=b[5];return h}g["default"]=a}),98);
__d("MWChatForwardCircleButton.react",["fbt","FDSCircleButton.react","MDSShareSvgIcon.react","ODS","SVGIcon","react","react-compiler-runtime"],(function(a,b,c,d,e,f,g,h){"use strict";var i,j,k=i||d("react");function a(a){var b=d("react-compiler-runtime").c(9),e=a.color,f=a.onOpenForwardDialog;a=a.type;var g;b[0]!==e?(g=d("SVGIcon").legacySVGIcon(function(){return k.jsx(c("MDSShareSvgIcon.react"),{color:e,size:24})}),b[0]=e,b[1]=g):g=b[1];var i;b[2]===Symbol["for"]("react.memo_cache_sentinel")?(i=h._(/*BTDS*/"\u041f\u0435\u0440\u0435\u0441\u043b\u0430\u0442\u044c"),b[2]=i):i=b[2];var l;b[3]!==f?(l=function(){(j||(j=d("ODS"))).bumpEntityKey(3185,"mwchat_media_viewer","forward"),f()},b[3]=f,b[4]=l):l=b[4];bb0:{switch(a){case"deemphasized":a="deemphasized";break bb0;case"normal":a="normal";break bb0;case"overlay":a="overlay";break bb0;case"dark_overlay":a="dark-overlay";break bb0;case"deemphasized_overlay":case"overlay_raised":a="overlay-raised";break bb0;case"primary_background_overlay":a="primary-background-overlay";break bb0}a=void 0}b[5]!==g||b[6]!==l||b[7]!==a?(i=k.jsx(c("FDSCircleButton.react"),{icon:g,label:i,onPress:l,size:36,testid:void 0,type_DEPRECATED:a}),b[5]=g,b[6]=l,b[7]=a,b[8]=i):i=b[8];return i}g["default"]=a}),226);
__d("MWMediaViewerRenderQpl",["MWMediaRenderQplUtils"],(function(a,b,c,d,e,f,g){"use strict";function a(a,b){return d("MWMediaRenderQplUtils").useCommonMediaRenderQplForAttachment(a,b,"full_screen_view")}g.useMediaViewerRenderQpl=a}),98);
__d("MWSharedAttachmentsSectionHooks",["I64","LSIntEnum","LSThreadMediaGalleryGroup","MessagingAttachmentType","ReQL","ReQLSuspense","react","react-compiler-runtime","usePrevious","useReStore"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j,k,l=k||d("react");l.useCallback;var m=l.useEffect,n=l.useState;function a(a){var b=d("react-compiler-runtime").c(33),e=a.attachmentsRange,f=a.hasMore,g=a.loadMore,h=a.logLoadMediaCancel,i=a.logLoadMediaSuccess,j=a.media,k=a.skipInitialLoad;a=n(!1);var l=a[0],o=a[1],p=j.length,q=(a=c("usePrevious")(p))!=null?a:0,r=c("usePrevious")(f),s=(j=c("usePrevious")(l))!=null?j:!1,t=e!=null;b[0]!==t||b[1]!==g||b[2]!==k?(a=function(){!t&&k!==!0&&(g(),o(!0))},j=[t,g,k],b[0]=t,b[1]=g,b[2]=k,b[3]=a,b[4]=j):(a=b[3],j=b[4]);m(a,j);b[5]!==e||b[6]!==f||b[7]!==l||b[8]!==g||b[9]!==i||b[10]!==p||b[11]!==r||b[12]!==s||b[13]!==q?(a=function(){var a=q!==p,b=r===!0&&!f||e==null&&f===!1&&r===!1&&q===p;l&&(b||a)?(o(!1),i==null||i({fetchedMediaCount:p-q,startMediaCount:q})):q===p&&f&&l&&s===!0&&(i==null||i({fetchedMediaCount:p-q,isAlreadyPreloaded:!0,startMediaCount:q}),g())},b[5]=e,b[6]=f,b[7]=l,b[8]=g,b[9]=i,b[10]=p,b[11]=r,b[12]=s,b[13]=q,b[14]=a):a=b[14];b[15]!==e||b[16]!==f||b[17]!==l||b[18]!==g||b[19]!==h||b[20]!==i||b[21]!==p||b[22]!==r||b[23]!==s||b[24]!==q?(j=[p,f,l,q,r,e,g,s,i,h],b[15]=e,b[16]=f,b[17]=l,b[18]=g,b[19]=h,b[20]=i,b[21]=p,b[22]=r,b[23]=s,b[24]=q,b[25]=j):j=b[25];m(a,j);b[26]!==l||b[27]!==g?(h=function(){if(!l){g();return o(!0)}},b[26]=l,b[27]=g,b[28]=h):h=b[28];a=h;j=p>0||!l&&!f;b[29]!==j||b[30]!==l||b[31]!==a?(h=[l,a,j],b[29]=j,b[30]=l,b[31]=a,b[32]=h):h=b[32];return h}function o(a,b,e,g){var i=d("react-compiler-runtime").c(19),j;i[0]!==g?(j=g===void 0?{}:g,i[0]=g,i[1]=j):j=i[1];g=j;j=g.removeUnsentMessages;var k=j===void 0?!1:j,l=(h||(h=c("useReStore")))();g=t(a,b);j=g.attachmentsRange;b=g.hasMoreBefore;var m=g.minTimestampMs,n=g.query;i[2]!==l||i[3]!==e||i[4]!==k?(g=function(a){if(!e(a))return null;if(!k)return a;var b=d("ReQLSuspense").first(d("ReQL").fromTableAscending(l.tables.messages.index("messageId")).getKeyRange(a.messageId),f.id+":146");return b==null||b.isUnsent?null:a},i[2]=l,i[3]=e,i[4]=k,i[5]=g):g=i[5];var o=g;i[6]!==o||i[7]!==n?(g=function(){return n.map(o).filter(Boolean)},i[6]=o,i[7]=n,i[8]=g):g=i[8];var p;i[9]!==l||i[10]!==m||i[11]!==o||i[12]!==a?(p=[l,a,o,m],i[9]=l,i[10]=m,i[11]=o,i[12]=a,i[13]=p):p=i[13];a=d("ReQLSuspense").useArray(g,p,f.id+":159");i[14]!==a||i[15]!==j||i[16]!==b||i[17]!==m?(g=[a,j,m,b],i[14]=a,i[15]=j,i[16]=b,i[17]=m,i[18]=g):g=i[18];return g}function p(a){var b=a.attachmentType;a=a.defaultCtaType;return(i||(i=d("I64"))).equal(b,(j||(j=d("LSIntEnum"))).ofNumber(c("MessagingAttachmentType").XMA))?a==="xma_web_url"||a==="xma_open_native":!1}function b(a,b){var e=d("react-compiler-runtime").c(7),f;e[0]===Symbol["for"]("react.memo_cache_sentinel")?(f=(j||(j=d("LSIntEnum"))).ofNumber(c("LSThreadMediaGalleryGroup").LINKS),e[0]=f):f=e[0];a=o(a,f,p,b);f=a[0];b=a[1];var g=a[2];a=a[3];var h;e[1]===Symbol["for"]("react.memo_cache_sentinel")?(h=(j||(j=d("LSIntEnum"))).ofNumber(c("LSThreadMediaGalleryGroup").LINKS),e[1]=h):h=e[1];e[2]!==f||e[3]!==b||e[4]!==a||e[5]!==g?(h=[f,h,b,g,a],e[2]=f,e[3]=b,e[4]=a,e[5]=g,e[6]=h):h=e[6];return h}function q(a){a=a.attachmentType;return(i||(i=d("I64"))).equal(a,(j||(j=d("LSIntEnum"))).ofNumber(c("MessagingAttachmentType").IMAGE))||(i||(i=d("I64"))).equal(a,(j||(j=d("LSIntEnum"))).ofNumber(c("MessagingAttachmentType").VIDEO))}function e(a,b){var e=d("react-compiler-runtime").c(7),f;e[0]===Symbol["for"]("react.memo_cache_sentinel")?(f=(j||(j=d("LSIntEnum"))).ofNumber(c("LSThreadMediaGalleryGroup").PHOTOS_AND_VIDEOS),e[0]=f):f=e[0];a=o(a,f,q,b);f=a[0];b=a[1];var g=a[2];a=a[3];var h;e[1]===Symbol["for"]("react.memo_cache_sentinel")?(h=(j||(j=d("LSIntEnum"))).ofNumber(c("LSThreadMediaGalleryGroup").PHOTOS_AND_VIDEOS),e[1]=h):h=e[1];e[2]!==f||e[3]!==b||e[4]!==a||e[5]!==g?(h=[f,h,b,g,a],e[2]=f,e[3]=b,e[4]=a,e[5]=g,e[6]=h):h=e[6];return h}function r(a){a=a.attachmentType;return(i||(i=d("I64"))).equal(a,(j||(j=d("LSIntEnum"))).ofNumber(c("MessagingAttachmentType").FILE))}function s(a,b){var e=d("react-compiler-runtime").c(7),f;e[0]===Symbol["for"]("react.memo_cache_sentinel")?(f=(j||(j=d("LSIntEnum"))).ofNumber(c("LSThreadMediaGalleryGroup").FILES_ONLY),e[0]=f):f=e[0];a=o(a,f,r,b);f=a[0];b=a[1];var g=a[2];a=a[3];var h;e[1]===Symbol["for"]("react.memo_cache_sentinel")?(h=(j||(j=d("LSIntEnum"))).ofNumber(c("LSThreadMediaGalleryGroup").FILES_ONLY),e[1]=h):h=e[1];e[2]!==f||e[3]!==b||e[4]!==a||e[5]!==g?(h=[f,h,b,g,a],e[2]=f,e[3]=b,e[4]=a,e[5]=g,e[6]=h):h=e[6];return h}function t(a,b){var e=d("react-compiler-runtime").c(17),g=(h||(h=c("useReStore")))(),j;e[0]!==g.tables.attachments_ranges_v2__generated||e[1]!==b||e[2]!==a?(j=function(){return d("ReQL").fromTableDescending(g.tables.attachments_ranges_v2__generated).getKeyRange(a).filter(function(a){return(i||(i=d("I64"))).equal(a.mediaGroup,b)})},e[0]=g.tables.attachments_ranges_v2__generated,e[1]=b,e[2]=a,e[3]=j):j=e[3];var k;e[4]!==g||e[5]!==b||e[6]!==a?(k=[g,a,b],e[4]=g,e[5]=b,e[6]=a,e[7]=k):k=e[7];j=d("ReQLSuspense").useFirst(j,k,f.id+":284");k=j==null?void 0:j.minTimestampMs;var l=j==null?void 0:j.hasMoreBefore;if(e[8]!==g.tables.attachments||e[9]!==k||e[10]!==a){var m=d("ReQL").fromTableDescending(g.tables.attachments.index("fk_messages")).getKeyRange(a);m=k!=null&&(i||(i=d("I64"))).to_float(k)!==Number.MAX_SAFE_INTEGER?m.bounds({gte:d("ReQL").key(k)}):m;e[8]=g.tables.attachments;e[9]=k;e[10]=a;e[11]=m}else m=e[11];m=m;var n;e[12]!==j||e[13]!==l||e[14]!==k||e[15]!==m?(n={attachmentsRange:j,hasMoreBefore:l,minTimestampMs:k,query:m},e[12]=j,e[13]=l,e[14]=k,e[15]=m,e[16]=n):n=e[16];return n}g.useLoader=a;g.useQueryLinkAttachments=b;g.filterMediaAttachments=q;g.useQueryMediaAttachments=e;g.useQueryFileAttachments=s;g.useAttachmentsQuery=t}),98);
__d("MWV2MediaViewerControls.react",["fbt","FDSCircleButton.react","FDSPhotoDownloadFilled16Icon","Int64Hooks","LSMessagingThreadTypeUtil","MWChatForwardCircleButton.react","MWV2MediaViewerContext.react","MWXCircleButton.react","MWXIconCross","MWXIconDownload","MWXRow.react","MWXRowItem.react","MWXTooltip.react","MessengerWebUXLogger","cr:23109","cr:23148","cr:5308","cr:9742","gkx","react","react-compiler-runtime","useMWHasForwardAction","useMWV2MessageForwardAction"],(function(a,b,c,d,e,f,g,h){"use strict";var i,j=i||(i=d("react")),k=i.useContext,l=h._(/*BTDS*/"\u0421\u043a\u0430\u0447\u0430\u0442\u044c"),m=h._(/*BTDS*/"\u0417\u0430\u043a\u0440\u044b\u0442\u044c");function a(a){var e=d("react-compiler-runtime").c(32),f=a.attachment,g=a.message,h=a.onClose;a=a.thread;var i=k(d("MWV2MediaViewerContext.react").context),o=c("MessengerWebUXLogger").useInteractionLogger(),p;e[0]!==f||e[1]!==i?(p=i.getDownloadUrl(f,"MWV2MediaViewerControls"),e[0]=f,e[1]=i,e[2]=p):p=e[2];i=p;e[3]!==f||e[4]!==g?(p=g!=null&&f!=null&&b("cr:9742")!=null&&c("gkx")("16279")&&j.jsx(b("cr:9742"),{attachment:f,message:g}),e[3]=f,e[4]=g,e[5]=p):p=e[5];var q;e[6]!==g||e[7]!==h?(q=h!=null&&g!=null&&b("cr:23148")!=null&&j.jsx(b("cr:23148"),{message:g,onClose:h}),e[6]=g,e[7]=h,e[8]=q):q=e[8];var r;e[9]!==g||e[10]!==a?(r=g!=null&&b("cr:23109")!=null&&j.jsx(b("cr:23109"),{message:g,thread:a}),e[9]=g,e[10]=a,e[11]=r):r=e[11];var s;e[12]!==g||e[13]!==a?(s=g!=null&&b("cr:5308")!=null&&j.jsx(b("cr:5308"),{message:g,thread:a}),e[12]=g,e[13]=a,e[14]=s):s=e[14];var t;e[15]!==o||e[16]!==i?(t=i!=null?j.jsx(c("MWXRowItem.react"),{children:j.jsx(c("MWXTooltip.react"),{tooltip:l,children:c("gkx")("16207")?j.jsx(c("MWXCircleButton.react"),{icon:c("MWXIconDownload"),label:l,linkProps:{download:!0,target:"_blank",url:i},onPress:function(){o==null||o({eventName:"fsmv_download_click"})},size:36,type:"dark-overlay"}):j.jsx(c("FDSCircleButton.react"),{color_DEPRECATED:"white",icon:c("FDSPhotoDownloadFilled16Icon"),label:l,linkProps:{download:!0,target:"_blank",url:i},onPress:function(){o==null||o({eventName:"fsmv_download_click"})},size:36,type_DEPRECATED:"dark-overlay"})})}):null,e[15]=o,e[16]=i,e[17]=t):t=e[17];e[18]!==f||e[19]!==g||e[20]!==a?(i=g!=null?j.jsx(n,{attachment:f,message:g,thread:a}):null,e[18]=f,e[19]=g,e[20]=a,e[21]=i):i=e[21];e[22]!==h?(f=h!=null?j.jsx(c("MWXRowItem.react"),{children:j.jsx(c("MWXTooltip.react"),{tooltip:m,children:j.jsx(c("MWXCircleButton.react"),{icon:c("MWXIconCross"),label:m,onPress:h,size:36,type:"dark-overlay"})})}):null,e[22]=h,e[23]=f):f=e[23];e[24]!==p||e[25]!==q||e[26]!==r||e[27]!==s||e[28]!==t||e[29]!==i||e[30]!==f?(g=j.jsxs(c("MWXRow.react"),{paddingTop:0,spacing:8,children:[p,q,r,s,t,i,f]}),e[24]=p,e[25]=q,e[26]=r,e[27]=s,e[28]=t,e[29]=i,e[30]=f,e[31]=g):g=e[31];return g}function n(a){var b=d("react-compiler-runtime").c(9),e=a.attachment,f=a.message,g=a.thread;a=e==null?void 0:e.attachmentFbid;var i;b[0]!==g.threadType?(i=d("LSMessagingThreadTypeUtil").isArmadilloSecure(g.threadType),b[0]=g.threadType,b[1]=i):i=b[1];i=i;var k,l;b[2]!==g.threadType?(k=function(){return g.threadType},l=[g.threadType],b[2]=g.threadType,b[3]=k,b[4]=l):(k=b[3],l=b[4]);k=d("Int64Hooks").useMemoInt64(k,l);l=c("useMWV2MessageForwardAction")(i,f,k);i=c("useMWHasForwardAction")(g.threadType,f,e);k=i.shouldShowForwardAction;if(a==null||!k)return null;b[5]===Symbol["for"]("react.memo_cache_sentinel")?(f=h._(/*BTDS*/"\u041f\u0435\u0440\u0435\u0441\u043b\u0430\u0442\u044c"),b[5]=f):f=b[5];b[6]!==a||b[7]!==l?(e=j.jsx(c("MWXRowItem.react"),{children:j.jsx(c("MWXTooltip.react"),{tooltip:f,children:j.jsx(c("MWChatForwardCircleButton.react"),{attachmentID:a,color:"white",onOpenForwardDialog:l,type:"dark_overlay"})})}),b[6]=a,b[7]=l,b[8]=e):e=b[8];return e}g["default"]=a}),226);
__d("MWV2MediaViewerControlsContainer.react",["CometPlaceholder.react","MWV2MediaViewerControls.react","MWV2MediaViewerControlsFallback.react","react","react-compiler-runtime"],(function(a,b,c,d,e,f,g){"use strict";var h,i=h||d("react");function a(a){var b=d("react-compiler-runtime").c(10),e=a.attachment,f=a.message,g=a.onClose;a=a.thread;var h;b[0]!==g?(h=g!=null?i.jsx(c("MWV2MediaViewerControlsFallback.react"),{onClose:g}):null,b[0]=g,b[1]=h):h=b[1];var j;b[2]!==e||b[3]!==f||b[4]!==g||b[5]!==a?(j=i.jsx(c("MWV2MediaViewerControls.react"),{attachment:e,message:f,onClose:g,thread:a}),b[2]=e,b[3]=f,b[4]=g,b[5]=a,b[6]=j):j=b[6];b[7]!==h||b[8]!==j?(e=i.jsx(c("CometPlaceholder.react"),{fallback:h,name:"MWV2MediaViewerContent.Controls",children:j}),b[7]=h,b[8]=j,b[9]=e):e=b[9];return e}g["default"]=a}),98);
__d("MWV2MediaViewerAspectRatioContainer.react",["BaseAspectRatioContainer.react","react","react-compiler-runtime","stylex"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j=i||d("react"),k={containerMaxSize:function(a,b){return[{aspectRatio:b==null?null:"x1f7gzso",marginTop:"xr1yuqi",marginInlineEnd:"x11t971q",marginBottom:"x4ii5y1",marginInlineStart:"xvc5jky",maxHeight:"min(calc(100vh - 76px),"+(a!=null?a:1e4)+"px)"==null?null:"x1kb659o",$$css:!0},{"--aspectRatio":b!=null?b:void 0,"--maxHeight":function(a){return typeof a==="number"?a+"px":a!=null?a:void 0}("min(calc(100vh - 76px),"+(a!=null?a:1e4)+"px)")}]}};function a(a){var b=d("react-compiler-runtime").c(14),e=a.children,f=a.height,g=a.onClickOutsideOfChildren;a=a.width;a=a!=null&&f!=null?a/f:1;var i;b[0]===Symbol["for"]("react.memo_cache_sentinel")?(i={className:"x5yr21d xh8yej3"},b[0]=i):i=b[0];var m;b[1]===Symbol["for"]("react.memo_cache_sentinel")?(m={className:"x1m82ljr x1dkd41z xbudbmw xr1yuqi x11t971q x4ii5y1 xvc5jky x1n2onr6 xwa60dl x11lhmoz"},b[1]=m):m=b[1];var n;b[2]!==a||b[3]!==f?(n=(h||(h=c("stylex"))).props(k.containerMaxSize(f,a)),b[2]=a,b[3]=f,b[4]=n):n=b[4];b[5]!==a||b[6]!==e?(f=j.jsx(c("BaseAspectRatioContainer.react"),{aspectRatio:a,children:e}),b[5]=a,b[6]=e,b[7]=f):f=b[7];b[8]!==n||b[9]!==f?(a=j.jsx("div",babelHelpers["extends"]({},m,{children:j.jsx("div",babelHelpers["extends"]({},n,{"aria-hidden":!0,onClick:l,children:f}))})),b[8]=n,b[9]=f,b[10]=a):a=b[10];b[11]!==g||b[12]!==a?(e=j.jsx("div",babelHelpers["extends"]({"aria-hidden":!0},i,{onClick:g,children:a})),b[11]=g,b[12]=a,b[13]=e):e=b[13];return e}function l(a){a.cancelBubble=!0,a.stopPropagation()}g["default"]=a}),98);
__d("MWV2MediaViewerItemImage.react",["fbt","BaseImage.react","I64","MWAnimatedImageControlsUtil","MWAnimatedImageThumbnailWithPlayButton.react","MWV2MediaViewerAspectRatioContainer.react","MWV2MediaViewerContext.react","MWXIconHd","MWXIconStrict.react","MWXPressable.react","MWXThreadThemeColor","MessagingAttachmentType","cr:9814","react","react-compiler-runtime"],(function(a,b,c,d,e,f,g,h){"use strict";var i,j,k=i||(i=d("react"));e=i;var l=e.useContext,m=e.useEffect,n=e.useRef,o=e.useState;function a(a){var e=d("react-compiler-runtime").c(36),f=a.attachment,g=a.mediaRenderQpl;a=a.onClickOutsideOfImage;var i=d("MWAnimatedImageControlsUtil").useGetMessengerAutoplaySetting(),q=l(d("MWV2MediaViewerContext.react").context),r=q.getPlayableUrl;q=q.heroLoggingComponent;var s=n(null),t=o(!1),u=t[0],v=t[1],w;e[0]!==g?(t=function(){var a;s.current!=null&&(a=s.current)!=null&&a.complete&&g.endSuccess()},w=[g],e[0]=g,e[1]=t,e[2]=w):(t=e[1],w=e[2]);m(t,w);e[3]!==f.previewHeight||e[4]!==f.previewHeightLarge?(t=f.previewHeightLarge!=null?(j||(j=d("I64"))).to_float(f.previewHeightLarge):f.previewHeight!=null?(j||(j=d("I64"))).to_float(f.previewHeight):void 0,e[3]=f.previewHeight,e[4]=f.previewHeightLarge,e[5]=t):t=e[5];w=t;e[6]!==f.previewWidth||e[7]!==f.previewWidthLarge?(t=f.previewWidthLarge!=null?(j||(j=d("I64"))).to_float(f.previewWidthLarge):f.previewWidth!=null?(j||(j=d("I64"))).to_float(f.previewWidth):void 0,e[6]=f.previewWidth,e[7]=f.previewWidthLarge,e[8]=t):t=e[8];t=t;var x=(j||(j=d("I64"))).to_int32(f.attachmentType)===c("MessagingAttachmentType").ANIMATED_IMAGE,y;e[9]!==f||e[10]!==r||e[11]!==g?(y=r(f,"MediaViewerImage",g),e[9]=f,e[10]=r,e[11]=g,e[12]=y):y=e[12];r=y;if(r!=null){var z=x&&i!==d("MWAnimatedImageControlsUtil").MWAutoplayAnimationsSetting.ON;e[13]!==q?(y=q("MWV2MediaViewerImage"),e[13]=q,e[14]=y):y=e[14];e[15]!==f||e[16]!==w||e[17]!==u||e[18]!==g||e[19]!==z||e[20]!==r||e[21]!==t?(x=z?u===!1?k.jsx(d("MWAnimatedImageThumbnailWithPlayButton.react").MWAnimatedImageThumbnailWithPlayButton,{connectBottom:!1,connectTop:!1,dbAttachment:f,entryPoint:d("MWAnimatedImageThumbnailWithPlayButton.react").AnimatedImageEntryPoint.MediaViewer,mediaRenderQpl:g,message:null,onPlay:function(){return v(!0)},outgoing:!1,previewHeight:w,previewWidth:t}):k.jsx(c("MWXPressable.react"),{"aria-label":h._(/*BTDS*/"\u041f\u0440\u0438\u043e\u0441\u0442\u0430\u043d\u043e\u0432\u0438\u0442\u044c GIF-\u0430\u043d\u0438\u043c\u0430\u0446\u0438\u044e"),hideHoverOverlay:!0,onPress:function(){z&&v(!1)},children:k.jsx(c("BaseImage.react"),{height:"100%",objectFit:"contain",onError:function(){g.endFail("load-image-error")},onLoad:function(){g.endSuccess()},ref:s,src:r,width:"100%"})}):k.jsx(c("BaseImage.react"),{height:"100%",objectFit:"contain",onError:function(){g.endFail("load-image-error")},onLoad:function(){g.endSuccess()},ref:s,src:r,width:"100%"}),e[15]=f,e[16]=w,e[17]=u,e[18]=g,e[19]=z,e[20]=r,e[21]=t,e[22]=x):x=e[22];e[23]!==f?(i=k.jsx(p,{attachment:f}),q=b("cr:9814")&&k.jsx(b("cr:9814"),{attachment:f}),e[23]=f,e[24]=i,e[25]=q):(i=e[24],q=e[25]);e[26]!==y||e[27]!==x||e[28]!==i||e[29]!==q?(u=k.jsxs(k.Fragment,{children:[y,x,i,q]}),e[26]=y,e[27]=x,e[28]=i,e[29]=q,e[30]=u):u=e[30];e[31]!==w||e[32]!==a||e[33]!==u||e[34]!==t?(r=k.jsx(c("MWV2MediaViewerAspectRatioContainer.react"),{height:w,onClickOutsideOfChildren:a,width:t,children:u}),e[31]=w,e[32]=a,e[33]=u,e[34]=t,e[35]=r):r=e[35];return r}else{g.endFail("missing-playable-url");return null}}function p(a){var b=d("react-compiler-runtime").c(3);a=a.attachment;a=a;a=a.isHd===!0;if(!a)return null;var e;b[0]===Symbol["for"]("react.memo_cache_sentinel")?(a={className:"x78zum5 x5yr21d x10l6tqk xh8yej3"},e={className:"xdg88n9 x10l6tqk xomnu4r"},b[0]=a,b[1]=e):(a=b[0],e=b[1]);b[2]===Symbol["for"]("react.memo_cache_sentinel")?(a=k.jsx("div",babelHelpers["extends"]({},a,{children:k.jsx("div",babelHelpers["extends"]({},e,{children:k.jsx(c("MWXIconStrict.react"),{color:d("MWXThreadThemeColor").mwxThreadThemeColor("rgba(255,255,255,0.7)"),icon:c("MWXIconHd"),size:24})}))})),b[2]=a):a=b[2];return a}g["default"]=a}),226);
__d("MWV2MediaViewerItemVideo.react",["MWChatVideoPlayer.react","MWV2MediaViewerContext.react","cr:9814","react","react-compiler-runtime"],(function(a,b,c,d,e,f,g){"use strict";var h,i=h||(h=d("react")),j=h.useContext;function a(a){var e=d("react-compiler-runtime").c(15),f=a.attachment,g=a.isSecure;a=a.mediaRenderQpl;var h=j(d("MWV2MediaViewerContext.react").context);h=h.getPlayableUrl;var k;e[0]!==f||e[1]!==h||e[2]!==a?(k=h(f,"MediaViewerVideo",a),e[0]=f,e[1]=h,e[2]=a,e[3]=k):k=e[3];h=k;if(h!=null){e[4]===Symbol["for"]("react.memo_cache_sentinel")?(k={className:"x78zum5 x1iyjqo2 xmz0i5r"},e[4]=k):k=e[4];var l;e[5]!==f.attachmentFbid||e[6]!==g||e[7]!==a||e[8]!==h?(l=i.jsx(c("MWChatVideoPlayer.react"),{controls:"mwchat",fbid:f.attachmentFbid,hideExpandButton:!1,isMediaViewer:!0,isSecure:g,mediaRenderQpl:a,originalHeight:1e3,originalWidth:1e3,sdSrc:h,shouldForcePauseOnClick:!1}),e[5]=f.attachmentFbid,e[6]=g,e[7]=a,e[8]=h,e[9]=l):l=e[9];e[10]!==f?(g=b("cr:9814")&&i.jsx(b("cr:9814"),{attachment:f}),e[10]=f,e[11]=g):g=e[11];e[12]!==l||e[13]!==g?(h=i.jsxs("div",babelHelpers["extends"]({},k,{children:[l,g]})),e[12]=l,e[13]=g,e[14]=h):h=e[14];return h}else{a.endFail("missing-playable-url");return null}}g["default"]=a}),98);
__d("MWV2MediaViewerNullState.react",["fbt","CometColumn.react","CometColumnItem.react","FDSNullState.react","react","react-compiler-runtime"],(function(a,b,c,d,e,f,g,h){"use strict";var i,j=i||d("react");function a(){var a=d("react-compiler-runtime").c(1),b;a[0]===Symbol["for"]("react.memo_cache_sentinel")?(b=j.jsx(c("CometColumn.react"),{expanding:!0,verticalAlign:"center",children:j.jsx(c("CometColumnItem.react"),{children:j.jsx(c("FDSNullState.react"),{headline:h._(/*BTDS*/"\u042d\u0442\u043e\u0442 \u043a\u043e\u043d\u0442\u0435\u043d\u0442 \u0441\u0435\u0439\u0447\u0430\u0441 \u043d\u0435\u0434\u043e\u0441\u0442\u0443\u043f\u0435\u043d")})})}),a[0]=b):b=a[0];return b}g["default"]=a}),226);
__d("MWV2MediaViewerItem.react",["I64","LSIntEnum","MWMediaViewerRenderQpl","MWV2MediaViewerItemImage.react","MWV2MediaViewerItemVideo.react","MWV2MediaViewerNullState.react","MessagingAttachmentType","gkx","react","react-compiler-runtime"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j,k=h||d("react");function a(a){var b=d("react-compiler-runtime").c(12),e=a.attachment,f=a.isSecure,g=a.onClose;a=a.threadType;if(e==null){var h;b[0]===Symbol["for"]("react.memo_cache_sentinel")?(h=k.jsx(c("MWV2MediaViewerNullState.react"),{}),b[0]=h):h=b[0];return h}h=e.attachmentType;if(!((i||(i=d("I64"))).equal(h,(j||(j=d("LSIntEnum"))).ofNumber(c("MessagingAttachmentType").IMAGE))||(i||(i=d("I64"))).equal(h,(j||(j=d("LSIntEnum"))).ofNumber(c("MessagingAttachmentType").ANIMATED_IMAGE))||(i||(i=d("I64"))).equal(h,(j||(j=d("LSIntEnum"))).ofNumber(c("MessagingAttachmentType").VIDEO)))){b[1]===Symbol["for"]("react.memo_cache_sentinel")?(h=k.jsx(c("MWV2MediaViewerNullState.react"),{}),b[1]=h):h=b[1];return h}b[2]!==g?(h=c("gkx")("6691")&&k.jsx("div",babelHelpers["extends"]({"aria-hidden":!0},{className:"x1ey2m1c xtijo5x x1o0tod x10l6tqk x13vifvy"},{"data-testid":void 0,onClick:g})),b[2]=g,b[3]=h):h=b[3];var m;b[4]!==e||b[5]!==f||b[6]!==g||b[7]!==a?(m=k.jsx(l,{attachment:e,isSecure:f,onClose:g,threadType:a}),b[4]=e,b[5]=f,b[6]=g,b[7]=a,b[8]=m):m=b[8];b[9]!==h||b[10]!==m?(e=k.jsxs(k.Fragment,{children:[h,m]}),b[9]=h,b[10]=m,b[11]=e):e=b[11];return e}function l(a){var b=d("react-compiler-runtime").c(6),e=a.attachment,f=a.isSecure,g=a.onClose;a=a.threadType;a=d("MWMediaViewerRenderQpl").useMediaViewerRenderQpl(e,a);var h=e.attachmentType,l;b[0]!==e||b[1]!==f||b[2]!==a||b[3]!==g||b[4]!==h?(l=(i||(i=d("I64"))).equal(h,(j||(j=d("LSIntEnum"))).ofNumber(c("MessagingAttachmentType").IMAGE))||(i||(i=d("I64"))).equal(h,(j||(j=d("LSIntEnum"))).ofNumber(c("MessagingAttachmentType").ANIMATED_IMAGE))?k.jsx(c("MWV2MediaViewerItemImage.react"),{attachment:e,mediaRenderQpl:a,onClickOutsideOfImage:g}):(i||(i=d("I64"))).equal(h,(j||(j=d("LSIntEnum"))).ofNumber(c("MessagingAttachmentType").VIDEO))?k.jsx(c("MWV2MediaViewerItemVideo.react"),{attachment:e,isSecure:f,mediaRenderQpl:a}):null,b[0]=e,b[1]=f,b[2]=a,b[3]=g,b[4]=h,b[5]=l):l=b[5];return l}g["default"]=a}),98);
__d("MWV2MediaViewerContent.react",["fbt","CometHideLayerOnEscape.react","CometPlaceholder.react","FDSBlurredBackgroundImage.react","I64","LSIntEnum","LSMessagingThreadTypeUtil","MWChatAttachmentMediaNavigationHotkeys.react","MWChatAttachmentMediaState.react","MWChatAttachmentMediaThumbnails.react","MWChatMediaViewerNavigationTapTarget.react","MWV2MediaViewerContainer.react","MWV2MediaViewerContext.react","MWV2MediaViewerControlsContainer.react","MWV2MediaViewerItem.react","MWXColumn.react","MWXColumnItem.react","MWXRow.react","MWXRowItem.react","MessagingAttachmentType","ReQL","ReQLSuspense","gkx","justknobx","react","react-compiler-runtime","useReStore","useShouldShowPlaybackErrorFallback","useShouldShowUnsupportedCodecFallback"],(function(a,b,c,d,e,f,g,h){"use strict";var i,j,k,l,m=j||(j=d("react"));b=j;var n=b.useContext,o=b.useEffect,p={mediaItem:{marginTop:"x14vqqas",marginInlineEnd:"xbmvrgn",marginBottom:"xod5an3",marginInlineStart:"x1diwwjn",$$css:!0},mediaRow:{minHeight:"x2lwn1j",$$css:!0},noOverflow:{maxWidth:"x193iq5w",overflowX:"x6ikm8r",overflowY:"x10wlt62",$$css:!0}};function q(a){var b=d("react-compiler-runtime").c(6);a=a.attachment;var e=n(d("MWV2MediaViewerContext.react").context);e=e.getPreviewUrl;var f;b[0]!==a||b[1]!==e?(f=e(a,"BlurredBackground"),b[0]=a,b[1]=e,b[2]=f):f=b[2];e=f;if(e!=null&&a!=null&&!(k||(k=d("I64"))).equal(a.attachmentType,(l||(l=d("LSIntEnum"))).ofNumber(c("MessagingAttachmentType").ANIMATED_IMAGE))){b[3]===Symbol["for"]("react.memo_cache_sentinel")?(f={className:"x1ey2m1c xtijo5x x1o0tod xuzhngd x10l6tqk x13vifvy"},b[3]=f):f=b[3];b[4]!==e?(a=m.jsx("div",babelHelpers["extends"]({},f,{children:m.jsx(c("FDSBlurredBackgroundImage.react"),{src:e})})),b[4]=e,b[5]=a):a=b[5];return a}else return null}function a(a){var b=d("react-compiler-runtime").c(66),e=a.initialAttachment,g=a.onClose,j=a.shouldShowMessengerLogo;a=a.thread;var k=n(d("MWChatAttachmentMediaState.react").context),l=k.canMoveBackward,r=k.canMoveForward,s=k.card,t=k.moveBackward,u=k.moveForward;k=k.shouldTriggerLoadMore;var v=n(d("MWV2MediaViewerContext.react").context),w=v.getPreviewUrl,x=v.loadMore,y=(i||(i=c("useReStore")))(),z=e==null?void 0:e.threadKey,A=e==null?void 0:e.messageId;b[0]!==y.tables.attachments||b[1]!==A||b[2]!==z?(v=function(){return d("ReQL").fromTableDescending(y.tables.attachments).getKeyRange(z,A)},b[0]=y.tables.attachments,b[1]=A,b[2]=z,b[3]=v):v=b[3];var B;b[4]!==y||b[5]!==A||b[6]!==z?(B=[y,A,z],b[4]=y,b[5]=A,b[6]=z,b[7]=B):B=b[7];v=d("ReQLSuspense").useFirst(v,B,f.id+":109")!=null;var C=s!=null?s.attachment:v?e:void 0;b[8]!==C||b[9]!==y.tables.messages?(B=function(){return(C==null?void 0:C.messageId)==null?d("ReQL").empty():d("ReQL").fromTableAscending(y.tables.messages.index("messageId")).getKeyRange(C.messageId)},b[8]=C,b[9]=y.tables.messages,b[10]=B):B=b[10];s=C==null?void 0:C.messageId;b[11]!==y.tables.messages||b[12]!==s?(v=[s,y.tables.messages],b[11]=y.tables.messages,b[12]=s,b[13]=v):v=b[13];e=d("ReQLSuspense").useFirst(B,v,f.id+":125");var D=k;b[14]!==x||b[15]!==D?(s=function(){D&&x()},B=[D,x],b[14]=x,b[15]=D,b[16]=s,b[17]=B):(s=b[16],B=b[17]);o(s,B);v=c("gkx")("1775");k=c("useShouldShowUnsupportedCodecFallback")(C);s=c("useShouldShowPlaybackErrorFallback")(C);b[18]!==C||b[19]!==s||b[20]!==k||b[21]!==g||b[22]!==a?(B=!k&&!s?m.jsx(c("MWV2MediaViewerItem.react"),{attachment:C,isSecure:d("LSMessagingThreadTypeUtil").isArmadilloSecure(a.threadType),onClose:g,threadType:a.threadType}):null,b[18]=C,b[19]=s,b[20]=k,b[21]=g,b[22]=a,b[23]=B):B=b[23];s=B;b[24]===Symbol["for"]("react.memo_cache_sentinel")?(k=c("justknobx")._("3491"),b[24]=k):k=b[24];B=k;b[25]!==C||b[26]!==e||b[27]!==g||b[28]!==a?(k=m.jsx(c("MWV2MediaViewerControlsContainer.react"),{attachment:C,message:e,onClose:g,thread:a}),b[25]=C,b[26]=e,b[27]=g,b[28]=a,b[29]=k):k=b[29];b[30]!==g?(e=B?null:m.jsx(d("MWChatAttachmentMediaNavigationHotkeys.react").MWChatAttachmentMediaNavigationHotkeys,{onClose:v?g:void 0}),b[30]=g,b[31]=e):e=b[31];b[32]!==C?(a=m.jsx(c("CometPlaceholder.react"),{fallback:null,name:"MWV2MediaViewerContent.BlurredBackground",children:m.jsx(q,{attachment:C})}),b[32]=C,b[33]=a):a=b[33];var E;b[34]===Symbol["for"]("react.memo_cache_sentinel")?(E=[p.mediaRow,v&&p.noOverflow],b[34]=E):E=b[34];l=!l;var F;b[35]===Symbol["for"]("react.memo_cache_sentinel")?(F=h._(/*BTDS*/"\u041f\u0440\u0435\u0434\u044b\u0434\u0443\u0449\u0435\u0435 \u0444\u043e\u0442\u043e"),b[35]=F):F=b[35];b[36]!==t||b[37]!==l?(F=m.jsx(c("MWXRowItem.react"),{children:m.jsx(c("MWChatMediaViewerNavigationTapTarget.react"),{direction:"previous",invisible:l,label:F,onClick:t,testid:void 0})}),b[36]=t,b[37]=l,b[38]=F):F=b[38];b[39]!==s?(t=m.jsx(c("MWXRowItem.react"),{expanding:!0,verticalAlign:"stretch",xstyle:v&&p.mediaItem,children:m.jsx(c("CometPlaceholder.react"),{fallback:null,name:"MWV2MediaViewerContent.MediaContent",children:s})}),b[39]=s,b[40]=t):t=b[40];l=!r;b[41]===Symbol["for"]("react.memo_cache_sentinel")?(s=h._(/*BTDS*/"\u0421\u043b\u0435\u0434\u0443\u044e\u0449\u0435\u0435 \u0444\u043e\u0442\u043e"),b[41]=s):s=b[41];b[42]!==u||b[43]!==l?(r=m.jsx(c("MWXRowItem.react"),{children:m.jsx(c("MWChatMediaViewerNavigationTapTarget.react"),{direction:"next",invisible:l,label:s,onClick:u,testid:void 0})}),b[42]=u,b[43]=l,b[44]=r):r=b[44];b[45]!==F||b[46]!==t||b[47]!==r?(s=m.jsx(c("MWXColumnItem.react"),{expanding:!0,verticalAlign:"center",children:m.jsxs(c("MWXRow.react"),{align:"justify",expanding:!0,paddingHorizontal:0,paddingVertical:0,spacingHorizontal:v?0:void 0,verticalAlign:"stretch",xstyle:E,children:[F,t,r]})}),b[45]=F,b[46]=t,b[47]=r,b[48]=s):s=b[48];b[49]!==w?(u=m.jsx(c("MWXColumnItem.react"),{children:m.jsx(c("MWChatAttachmentMediaThumbnails.react"),{getPreviewUrl:w})}),b[49]=w,b[50]=u):u=b[50];b[51]!==s||b[52]!==u?(l=m.jsxs(c("MWXColumn.react"),{align:"stretch",expanding:!0,paddingHorizontal:0,verticalAlign:"space-between",children:[s,u]}),b[51]=s,b[52]=u,b[53]=l):l=b[53];b[54]!==j||b[55]!==k||b[56]!==e||b[57]!==a||b[58]!==l?(E=m.jsxs(c("MWV2MediaViewerContainer.react"),{actions:k,shouldShowMessengerLogo:j,children:[e,a,l]}),b[54]=j,b[55]=k,b[56]=e,b[57]=a,b[58]=l,b[59]=E):E=b[59];F=E;if(g!=null&&!v){b[60]!==F||b[61]!==g?(t=m.jsx(c("CometHideLayerOnEscape.react"),{onHide:g,children:F}),b[60]=F,b[61]=g,b[62]=t):t=b[62];return t}else{if(B){r=v?g:void 0;b[63]!==F||b[64]!==r?(w=m.jsx(d("MWChatAttachmentMediaNavigationHotkeys.react").MWChatAttachmentMediaNavigationHotkeys,{onClose:r,children:F}),b[63]=F,b[64]=r,b[65]=w):w=b[65];return w}return F}}g["default"]=a}),226);
__d("useLoadMoreThreadSharedAttachments.react",["Int64Hooks","LSFactory","LSIssueAttachmentsRangeQueryStoredProcedure","MAWThreadCutover","MWThreadKey.react","promiseDone","react-compiler-runtime","useAsyncReStore"],(function(a,b,c,d,e,f,g){"use strict";function a(a,b,e){var g=d("react-compiler-runtime").c(6),h=c("useAsyncReStore")(),i=d("MWThreadKey.react").useMWThreadKeyMemoized();i==null&&(i=b);b=d("MAWThreadCutover").useGetCutoverOpenThreadKey(i);var j=b!=null?b:i;g[0]!==h||g[1]!==j||g[2]!==e||g[3]!==a?(b=function(){e==null||e(),c("promiseDone")(h,function(b){return b.runInTransaction(function(b){return c("LSIssueAttachmentsRangeQueryStoredProcedure")(c("LSFactory")(b),{mediaGroup:a,threadKey:j})},"readwrite",void 0,void 0,f.id+":40")})},i=[e,h,a,j],g[0]=h,g[1]=j,g[2]=e,g[3]=a,g[4]=b,g[5]=i):(b=g[4],i=g[5]);return d("Int64Hooks").useCallbackInt64(b,i)}g["default"]=a}),98);
__d("useMAWLoadMoreThreadSharedAttachments",["I64","Int64Hooks","MAWBridgeSendAndReceive","MAWMediaGalleryEBTaggingUtils","MAWMiActOnActThreadReady","Promise","cr:20241","promiseDone","react-compiler-runtime","useReStore"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j;function a(a){var e=d("react-compiler-runtime").c(16),f=a.earliestLoadedMediaMessageId,g=a.hasMoreBefore,k=a.mediaGalleryGroup,l=a.minTimestampMs,m=a.pageSize,n=a.qplLogger,o=a.threadKey,p=(j||(j=c("useReStore")))(),q;e[0]!==g||e[1]!==l?(a=function(){return g!=null&&g&&l!=null?(i||(i=d("I64"))).to_float(l):Number.MAX_SAFE_INTEGER},q=[g,l],e[0]=g,e[1]=l,e[2]=a,e[3]=q):(a=e[2],q=e[3]);var r=d("Int64Hooks").useCallbackInt64(a,q);e[4]!==k?(a=d("MAWMediaGalleryEBTaggingUtils").isMediaGalleryGroupSupportedForTaggedRestore(k),e[4]=k,e[5]=a):a=e[5];var s=a;e[6]!==p.tables||e[7]!==f||e[8]!==r||e[9]!==s||e[10]!==k||e[11]!==m||e[12]!==n||e[13]!==o?(q=function(){o!=null&&(n==null||n.logLoadMediaStart==null||n.logLoadMediaStart(),c("promiseDone")(d("MAWMiActOnActThreadReady").onActThreadReady(p.tables,o,"useMAWLoadMoreThreadSharedAttachments",function(a,c){return(b("cr:20241")!=null&&s?b("cr:20241").MAWFetchAndPersistMedia(c,o,k,n):(h||(h=b("Promise"))).resolve()).then(function(){n==null||n.addPoint("fetch_from_maw_db",{"int":{mediaGalleryGroup:k}});return d("MAWBridgeSendAndReceive").sendAndReceive("backend","loadMoreMedia",{earliestLoadedMediaMessageId:f,earliestLoadedMediaTs:r(),mediaGalleryGroup:k,pageSize:m,threadJid:c})})})))},a=[o,p.tables,s,k,n,f,r,m],e[6]=p.tables,e[7]=f,e[8]=r,e[9]=s,e[10]=k,e[11]=m,e[12]=n,e[13]=o,e[14]=q,e[15]=a):(q=e[14],a=e[15]);return d("Int64Hooks").useCallbackInt64(q,a)}g["default"]=a}),98);
__d("useMAWQuerySecureMediaAttachments",["I64","LSIntEnum","LSThreadMediaGalleryGroup","MWSharedAttachmentsSectionHooks","ReQL","ReQLSuspense","justknobx","react","useReStore"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j,k;b=k||d("react");var l=b.useCallback,m=b.useMemo,n=c("justknobx")._("1132");function a(a,b){b=b===void 0?{}:b;b=b.removeUnsentMessages;var e=b===void 0?!1:b,g=(h||(h=c("useReStore")))();b=d("MWSharedAttachmentsSectionHooks").useAttachmentsQuery(a,(i||(i=d("LSIntEnum"))).ofNumber(c("LSThreadMediaGalleryGroup").PHOTOS_AND_VIDEOS));var k=b.attachmentsRange,p=b.hasMoreBefore,r=b.minTimestampMs,s=b.query,t=l(function(a){if(!d("MWSharedAttachmentsSectionHooks").filterMediaAttachments(a))return null;var b=d("ReQLSuspense").first(d("ReQL").fromTableAscending(g.tables.messages.index("messageId")).getKeyRange(a.messageId),f.id+":75");if(e&&(b==null||b.isUnsent))return null;return b==null?{attachment:a}:{attachment:a,message:b}},[g,e]),u=d("ReQLSuspense").useArray(function(){var a=s.map(t).filter(Boolean);(r==null||(j||(j=d("I64"))).equal(r,(j||(j=d("I64"))).zero))&&(a=a.take(n));return a},[g,a,t,r],f.id+":93"),v=m(function(){var a=o(u);a.sort(q);return a},[u]);b=m(function(){return v.map(function(a){a=a.attachment;return a})},[v]);return[b,i.ofNumber(c("LSThreadMediaGalleryGroup").PHOTOS_AND_VIDEOS),k,r,p]}function o(a){var b=p(a);return a.map(function(a){var c=a.attachment;a=a.message;var e=a==null?void 0:a.groupId,f=b.get(e!=null?e:"");if(e==null||f==null){return{attachment:c,message:a,sortKey:{sortingMessageGroupIndex:Number.MAX_SAFE_INTEGER,sortingMessageId:c.messageId,sortingMessagePrimarySortTS:(e=a==null?void 0:a.primarySortKey)!=null?e:c.timestampMs,sortingMessageSecondarySortTS:(e=(e=a==null?void 0:a.secondarySortKey)!=null?e:a==null?void 0:a.timestampMs)!=null?e:c.timestampMs}}}return{attachment:c,message:a,sortKey:{sortingMessageGroupIndex:(j||(j=d("I64"))).to_int32((e=a==null?void 0:a.groupIndex)!=null?e:(j||(j=d("I64"))).zero),sortingMessageId:f.messageId,sortingMessagePrimarySortTS:f.primarySortTs,sortingMessageSecondarySortTS:f.secondarySortTs}}})}function p(a){var b=new Map();a.forEach(function(a){var c;a=a.message;if(!a||a.groupId==null||a.groupIndex==null)return;var e=a.groupId,f=(j||(j=d("I64"))).to_int32(a.groupIndex);c=Math.min((c=(c=b.get(e))==null?void 0:c.groupIndex)!=null?c:Number.MAX_SAFE_INTEGER,f);f=f===c?{groupIndex:f,messageId:a.messageId,primarySortTs:a.primarySortKey,secondarySortTs:(c=a.secondarySortKey)!=null?c:a.timestampMs}:b.get(e);f&&b.set(e,f)});return b}function q(a,b){var c=a.sortKey,e=b.sortKey;a=a.message;b=b.message;if(!(j||(j=d("I64"))).equal(c.sortingMessagePrimarySortTS,e.sortingMessagePrimarySortTS))return(j||(j=d("I64"))).compare(e.sortingMessagePrimarySortTS,c.sortingMessagePrimarySortTS);if(!(j||(j=d("I64"))).equal(e.sortingMessageSecondarySortTS,c.sortingMessageSecondarySortTS))return(j||(j=d("I64"))).compare(e.sortingMessageSecondarySortTS,c.sortingMessageSecondarySortTS);if(c.sortingMessageId!==e.sortingMessageId)return e.sortingMessageId.localeCompare(c.sortingMessageId);return(a==null?void 0:a.groupId)!=null&&(b==null?void 0:b.groupId)!=null&&a.groupId===b.groupId?e.sortingMessageGroupIndex-c.sortingMessageGroupIndex:0}g["default"]=a}),98);
__d("useMWMediaLoadingQplLogger",["MWMediaRenderQplUtils","QPLUserFlow","QuickPerformanceLogger","Random","qpl","react","react-compiler-runtime"],(function(a,b,c,d,e,f,g){"use strict";var h,i;b=i||d("react");b.useCallback;var j=b.useEffect;b.useMemo;function a(a){var b=d("react-compiler-runtime").c(11),e=a.entrypoint,f=a.threadType;b[0]===Symbol["for"]("react.memo_cache_sentinel")?(a=o(),b[0]=a):a=b[0];a=a;var g=a;b[1]!==e||b[2]!==f?(a=function(a){var b;k({entrypoint:e,instanceKey:g,isCutoverThread:(b=a==null?void 0:a.isCutoverThread)!=null?b:!1,isPreCutoverMedia:(b=a==null?void 0:a.isPreCutoverMedia)!=null?b:!1,threadType:f})},b[1]=e,b[2]=f,b[3]=a):a=b[3];a=a;var i;b[4]===Symbol["for"]("react.memo_cache_sentinel")?(i=function(a){var b=a.fetchedMediaCount,c=a.isAlreadyPreloaded;a=a.startMediaCount;l({fetchedMediaCount:b,instanceKey:g,isAlreadyPreloaded:c,startMediaCount:a})},b[4]=i):i=b[4];i=i;var p;b[5]===Symbol["for"]("react.memo_cache_sentinel")?(p=function(){m({instanceKey:g})},b[5]=p):p=b[5];var q=p;b[6]===Symbol["for"]("react.memo_cache_sentinel")?(p=function(a,b){n({annotations:b,instanceKey:g,name:a})},b[6]=p):p=b[6];p=p;var r,s;b[7]===Symbol["for"]("react.memo_cache_sentinel")?(r=function(){return function(){var a=(h||(h=c("QuickPerformanceLogger"))).isMarkerOn(c("qpl")._(25300395,"1954"),g);a&&q()}},s=[g,q],b[7]=r,b[8]=s):(r=b[7],s=b[8]);j(r,s);b[9]!==a?(r={addPoint:p,logLoadMediaCancel:q,logLoadMediaStart:a,logLoadMediaSuccess:i},b[9]=a,b[10]=r):r=b[10];s=r;return s}function k(a){var b=a.entrypoint,e=a.instanceKey,f=a.isCutoverThread;f=f===void 0?!1:f;var g=a.isPreCutoverMedia;g=g===void 0?!1:g;a=a.threadType;c("QPLUserFlow").start(c("qpl")._(25300395,"1954"),{annotations:{bool:{isCutoverThread:f,isPreCutoverMedia:g},string:{entrypoint:b,threadType:d("MWMediaRenderQplUtils").getThreadTypeStringFromEnum(a)}},cancelOnUnload:!0,instanceKey:e,timeoutInMs:60*1e3})}function l(a){var b=a.fetchedMediaCount,d=a.instanceKey,e=a.isAlreadyPreloaded;a=a.startMediaCount;c("QPLUserFlow").endSuccess(c("qpl")._(25300395,"1954"),{annotations:{bool:{isAlreadyPreloaded:e!=null?e:!1},"int":{fetchedMediaCount:b,startMediaCount:a}},instanceKey:d})}function m(a){a=a.instanceKey;c("QPLUserFlow").endCancel(c("qpl")._(25300395,"1954"),{instanceKey:a})}function n(a){var b=a.annotations,d=a.instanceKey;a=a.name;c("QPLUserFlow").addPoint(c("qpl")._(25300395,"1954"),a,{data:b,instanceKey:d})}function o(){return Date.now()+Math.round(d("Random").random()*1e4)}g["default"]=a}),98);
__d("useMAWLoadMoreCutoverThreadSharedAttachments",["MAWDbMsg","MWSharedAttachmentsSectionHooks","gkx","justknobx","react","react-compiler-runtime","useLoadMoreThreadSharedAttachments.react","useMAWLoadMoreThreadSharedAttachments","useMAWQuerySecureMediaAttachments","useMWMediaLoadingQplLogger"],(function(a,b,c,d,e,f,g){"use strict";var h;(h||d("react")).useCallback;function a(a,b,e,f,g,h,j){var k=d("react-compiler-runtime").c(56),l=c("useMAWQuerySecureMediaAttachments")(a),m=l[0],n=l[1],o=l[2],p=l[3];l=l[4];var q;k[0]!==(o==null?void 0:o.lastLoadedMessageId)?(q=(o==null?void 0:o.lastLoadedMessageId)!=null?d("MAWDbMsg").toMsgId(o==null?void 0:o.lastLoadedMessageId):void 0,k[0]=o==null?void 0:o.lastLoadedMessageId,k[1]=q):q=k[1];q=q;var r=l!=null?l:!0,s;k[2]!==f.entrypoint||k[3]!==e?(s={entrypoint:f.entrypoint,threadType:e},k[2]=f.entrypoint,k[3]=e,k[4]=s):s=k[4];var t=c("useMWMediaLoadingQplLogger")(s);k[5]!==t?(f=function(){t.logLoadMediaStart({isCutoverThread:!0,isPreCutoverMedia:!1})},k[5]=t,k[6]=f):f=k[6];e=f;s=q!=null?q:void 0;k[7]!==e||k[8]!==t?(f=babelHelpers["extends"]({},t,{logLoadMediaStart:e}),k[7]=e,k[8]=t,k[9]=f):f=k[9];k[10]!==l||k[11]!==g||k[12]!==p||k[13]!==j||k[14]!==a||k[15]!==s||k[16]!==f?(q={earliestLoadedMediaMessageId:s,hasMoreBefore:l,mediaGalleryGroup:g,minTimestampMs:p,pageSize:j,qplLogger:f,threadKey:a},k[10]=l,k[11]=g,k[12]=p,k[13]=j,k[14]=a,k[15]=s,k[16]=f,k[17]=q):q=k[17];e=c("useMAWLoadMoreThreadSharedAttachments")(q);l=d("MWSharedAttachmentsSectionHooks").useQueryMediaAttachments(b);g=l[0];p=l[2];j=l[4];k[18]===Symbol["for"]("react.memo_cache_sentinel")?(a=c("justknobx")._("2968"),k[18]=a):a=k[18];s=a;f=(j!=null?j:c("gkx")("6241"))?s:!1;k[19]!==t?(q=function(){t.logLoadMediaStart({isCutoverThread:!0,isPreCutoverMedia:!0})},k[19]=t,k[20]=q):q=k[20];l=q;a=c("useLoadMoreThreadSharedAttachments.react")(n,b,l);k[21]!==o||k[22]!==r||k[23]!==e||k[24]!==m||k[25]!==t.logLoadMediaCancel||k[26]!==t.logLoadMediaSuccess?(j={attachmentsRange:o,hasMore:r,loadMore:e,logLoadMediaCancel:t.logLoadMediaCancel,logLoadMediaSuccess:t.logLoadMediaSuccess,media:m},k[21]=o,k[22]=r,k[23]=e,k[24]=m,k[25]=t.logLoadMediaCancel,k[26]=t.logLoadMediaSuccess,k[27]=j):j=k[27];s=d("MWSharedAttachmentsSectionHooks").useLoader(j);q=s[0];n=s[1];b=s[2];l=r||q;k[28]!==p||k[29]!==f||k[30]!==a||k[31]!==g||k[32]!==t.logLoadMediaCancel||k[33]!==t.logLoadMediaSuccess||k[34]!==l?(o={attachmentsRange:p,hasMore:f,loadMore:a,logLoadMediaCancel:t.logLoadMediaCancel,logLoadMediaSuccess:t.logLoadMediaSuccess,media:g,skipInitialLoad:l},k[28]=p,k[29]=f,k[30]=a,k[31]=g,k[32]=t.logLoadMediaCancel,k[33]=t.logLoadMediaSuccess,k[34]=l,k[35]=o):o=k[35];e=d("MWSharedAttachmentsSectionHooks").useLoader(o);j=e[0];s=e[1];p=e[2];if(r||q||h===!0){k[36]!==b||k[37]!==r||k[38]!==q||k[39]!==m||k[40]!==n?(a={attachments:m,completedFirstLoad:b,hasMore:r,isLoadingMore:q,onLoadMore:n},k[36]=b,k[37]=r,k[38]=q,k[39]=m,k[40]=n,k[41]=a):a=k[41];return a}else if(f||j){k[42]!==g||k[43]!==m?(l=m.concat(g),k[42]=g,k[43]=m,k[44]=l):l=k[44];k[45]!==p||k[46]!==f||k[47]!==j||k[48]!==s||k[49]!==l?(o={attachments:l,completedFirstLoad:p,hasMore:f,isLoadingMore:j,onLoadMore:s},k[45]=p,k[46]=f,k[47]=j,k[48]=s,k[49]=l,k[50]=o):o=k[50];return o}else{k[51]!==g||k[52]!==m?(e=m.concat(g),k[51]=g,k[52]=m,k[53]=e):e=k[53];k[54]!==e?(h={attachments:e,completedFirstLoad:!0,hasMore:!1,isLoadingMore:!1,onLoadMore:i},k[54]=e,k[55]=h):h=k[55];return h}}function i(){}g["default"]=a}),98);
__d("useMWMaybeInboxMediaRestoreLoop",["cr:20239","react-compiler-runtime"],(function(a,b,c,d,e,f,g){"use strict";function a(a){var c=d("react-compiler-runtime").c(2);a=b("cr:20239")(a);var e;c[0]!==a?(e=a!=null?a:{onEBOnboarded:i,startMediaSync:h},c[0]=a,c[1]=e):e=c[1];return e}function h(){}function i(){}g["default"]=a}),98);
__d("useMWV2MediaViewerOpenPlayableUrl",["I64","LSIntEnum","LSMediaUrlAttachment","MessagingAttachmentType","react"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j;(h||d("react")).useCallback;function a(){return k}function k(a){if(a==null)return;return(i||(i=d("I64"))).equal(a.attachmentType,(j||(j=d("LSIntEnum"))).ofNumber(c("MessagingAttachmentType").ANIMATED_IMAGE))?d("LSMediaUrlAttachment").previewUrl(a):d("LSMediaUrlAttachment").playableUrl(a)}g["default"]=a}),98);
__d("useMWV2MediaViewerOpenDownloadUrl",["react","react-compiler-runtime","useMWV2MediaViewerOpenPlayableUrl"],(function(a,b,c,d,e,f,g){"use strict";var h;(h||d("react")).useCallback;function a(){var a=d("react-compiler-runtime").c(2),b=c("useMWV2MediaViewerOpenPlayableUrl")(),e;a[0]!==b?(e=function(a,c,d){a=b(a,c,d);if(a==null)return;c=new URL(a);c.searchParams.set("dl","1");return c.toString()},a[0]=b,a[1]=e):e=a[1];return e}g["default"]=a}),98);
__d("useMWV2MediaViewerOpenPreviewUrl",["LSMediaUrlAttachment","react"],(function(a,b,c,d,e,f,g){"use strict";var h;(h||d("react")).useCallback;function a(){return i}function i(a){return a!=null?d("LSMediaUrlAttachment").previewUrl(a):void 0}g["default"]=a}),98);
__d("useMWV2MediaViewerSecurePreviewUrl_CausesSuspense",["cr:5931","react"],(function(a,b,c,d,e,f,g){"use strict";var h;(h||d("react")).useCallback;function a(){return i}function i(a,c,d){return b("cr:5931")==null?void 0:b("cr:5931").getThumbnailBlob_CausesSuspense(a,c,d)}g["default"]=a}),98);
__d("MWV2MediaViewerCutoverWrapper.react",["LSThreadMediaGalleryGroup","MWChatAttachmentMediaState.react","MWMessageSearchStatusTypes","MWV2MediaViewerContext.react","emptyFunction","justknobx","react","react-compiler-runtime","useMAWLoadMoreCutoverThreadSharedAttachments","useMWMaybeInboxMediaRestoreLoop","useMWMediaGalleryRestoreStatus","useMWV2MediaViewerOpenDownloadUrl","useMWV2MediaViewerOpenPlayableUrl","useMWV2MediaViewerOpenPreviewUrl","useMWV2MediaViewerSecurePlayableUrl_CausesSuspense","useMWV2MediaViewerSecurePreviewUrl_CausesSuspense"],(function(a,b,c,d,e,f,g){"use strict";var h,i=h||(h=d("react"));h.useCallback;function a(a){var b=d("react-compiler-runtime").c(30),e=a.children,f=a.initialAttachment,g=a.openThreadKey,h=a.secureThreadKey;a=a.threadType;var k;b[0]!==h||b[1]!==a?(k={threadKey:h,threadType:a},b[0]=h,b[1]=a,b[2]=k):k=b[2];c("useMWMaybeInboxMediaRestoreLoop")(k);b[3]!==h||b[4]!==a?(k={threadKey:h,threadType:a},b[3]=h,b[4]=a,b[5]=k):k=b[5];k=c("useMWMediaGalleryRestoreStatus")(k);k=k===d("MWMessageSearchStatusTypes").RestoreStatus.IN_PROGRESS;var l;b[6]===Symbol["for"]("react.memo_cache_sentinel")?(l={entrypoint:"media_viewer"},b[6]=l):l=b[6];var m;b[7]===Symbol["for"]("react.memo_cache_sentinel")?(m=c("justknobx")._("3233"),b[7]=m):m=b[7];h=c("useMAWLoadMoreCutoverThreadSharedAttachments")(h,g,a,l,c("LSThreadMediaGalleryGroup").PHOTOS_AND_VIDEOS,k,m);g=h.attachments;a=h.onLoadMore;var n=j,o=c("useMWV2MediaViewerOpenPreviewUrl")(),p=c("useMWV2MediaViewerOpenPlayableUrl")(),q=c("useMWV2MediaViewerOpenDownloadUrl")(),r=c("useMWV2MediaViewerSecurePreviewUrl_CausesSuspense")(),s=c("useMWV2MediaViewerSecurePlayableUrl_CausesSuspense")();b[8]!==o||b[9]!==r?(l=function(a,b,c){if(!a)return"";return!n(a)?o(a,b,c):r(a,b,c)},b[8]=o,b[9]=r,b[10]=l):l=b[10];k=l;b[11]!==p||b[12]!==s?(m=function(a,b,c){if(a==null)return"";return!n(a)?p(a,b,c):s(a,b,c)},b[11]=p,b[12]=s,b[13]=m):m=b[13];h=m;b[14]!==q||b[15]!==s?(l=function(a,b,c){if(a==null)return"";return!n(a)?q(a,b,c):s(a,b,c)},b[14]=q,b[15]=s,b[16]=l):l=b[16];m=l;b[17]!==g||b[18]!==e||b[19]!==h||b[20]!==k||b[21]!==f?(l=i.jsx(d("MWChatAttachmentMediaState.react").MWChatAttachmentMediaStateProviderFromAttachments,{attachments:g,getIsSecureThread:n,getPlayableUrl:h,getPreviewUrl:k,initialAttachment:f,children:e}),b[17]=g,b[18]=e,b[19]=h,b[20]=k,b[21]=f,b[22]=l):l=b[22];b[23]!==g||b[24]!==m||b[25]!==h||b[26]!==k||b[27]!==a||b[28]!==l?(e=i.jsx(d("MWV2MediaViewerContext.react").MWV2MediaViewerContextProvider,{getDownloadUrl:m,getPlayableUrl:h,getPreviewUrl:k,heroLoggingComponent:c("emptyFunction"),loadMore:a,media:g,children:l}),b[23]=g,b[24]=m,b[25]=h,b[26]=k,b[27]=a,b[28]=l,b[29]=e):e=b[29];return e}function j(a){return!((a==null?void 0:a.transportKey)==="FBBroker"||(a==null?void 0:a.transportKey)==="FBLegacyBroker")}g["default"]=a}),98);
__d("MWV2MediaViewerOpenWrapper.react",["CometHero.react","MWChatAttachmentMediaState.react","MWSharedAttachmentsSectionHooks","MWV2MediaViewerContext.react","react","react-compiler-runtime","useLoadMoreThreadSharedAttachments.react","useMWMediaLoadingQplLogger","useMWV2MediaViewerOpenDownloadUrl","useMWV2MediaViewerOpenPlayableUrl","useMWV2MediaViewerOpenPreviewUrl"],(function(a,b,c,d,e,f,g){"use strict";var h,i=h||(h=d("react"));h.useCallback;function a(a){var b=d("react-compiler-runtime").c(22),e=a.children,f=a.initialAttachment;a=a.thread;var g=d("MWSharedAttachmentsSectionHooks").useQueryMediaAttachments(a.threadKey),h=g[0],l=g[1],m=g[2];g=g[4];var n;b[0]!==a.threadType?(n={entrypoint:"media_viewer",threadType:a.threadType},b[0]=a.threadType,b[1]=n):n=b[1];n=c("useMWMediaLoadingQplLogger")(n);l=c("useLoadMoreThreadSharedAttachments.react")(l,a.threadKey,n.logLoadMediaStart);a=g!=null?g:!0;b[2]!==m||b[3]!==l||b[4]!==h||b[5]!==n.logLoadMediaCancel||b[6]!==n.logLoadMediaSuccess||b[7]!==a?(g={attachmentsRange:m,hasMore:a,loadMore:l,logLoadMediaCancel:n.logLoadMediaCancel,logLoadMediaSuccess:n.logLoadMediaSuccess,media:h},b[2]=m,b[3]=l,b[4]=h,b[5]=n.logLoadMediaCancel,b[6]=n.logLoadMediaSuccess,b[7]=a,b[8]=g):g=b[8];m=d("MWSharedAttachmentsSectionHooks").useLoader(g);l=m[1];n=c("useMWV2MediaViewerOpenPreviewUrl")();a=c("useMWV2MediaViewerOpenPlayableUrl")();g=c("useMWV2MediaViewerOpenDownloadUrl")();m=k;b[9]!==e||b[10]!==a||b[11]!==n||b[12]!==f||b[13]!==h?(m=i.jsx(d("MWChatAttachmentMediaState.react").MWChatAttachmentMediaStateProviderFromAttachments,{attachments:h,getIsSecureThread:m,getPlayableUrl:a,getPreviewUrl:n,initialAttachment:f,children:e}),b[9]=e,b[10]=a,b[11]=n,b[12]=f,b[13]=h,b[14]=m):m=b[14];b[15]!==g||b[16]!==a||b[17]!==n||b[18]!==l||b[19]!==h||b[20]!==m?(e=i.jsx(d("MWV2MediaViewerContext.react").MWV2MediaViewerContextProvider,{getDownloadUrl:g,getPlayableUrl:a,getPreviewUrl:n,heroLoggingComponent:j,loadMore:l,media:h,children:m}),b[15]=g,b[16]=a,b[17]=n,b[18]=l,b[19]=h,b[20]=m,b[21]=e):e=b[21];return e}function j(a){return i.jsx(c("CometHero.react"),{description:a})}j.displayName=j.name+" [from "+f.id+"]";function k(){return!1}g["default"]=a}),98);
__d("MWV2MediaViewerSecureWrapper.react",["LSThreadMediaGalleryGroup","MAWDbMsg","MWChatAttachmentMediaState.react","MWSharedAttachmentsSectionHooks","MWV2MediaViewerContext.react","MWV2MediaViewerNullState.react","cr:5709","cr:5931","cr:5970","emptyFunction","justknobx","react","react-compiler-runtime","useMAWQuerySecureMediaAttachments","useMWMaybeInboxMediaRestoreLoop","useMWMediaLoadingQplLogger","useMWV2MediaViewerSecurePlayableUrl_CausesSuspense","useMWV2MediaViewerSecurePreviewUrl_CausesSuspense"],(function(a,b,c,d,e,f,g){"use strict";var h,i=h||(h=d("react"));h.useCallback;function a(a){return j}function j(){}var k=b("cr:5709")==null?a:b("cr:5709");function e(a){var e=d("react-compiler-runtime").c(34),f=a.children,g=a.initialAttachment;a=a.thread;var h=c("useMAWQuerySecureMediaAttachments")(a.threadKey),j=h[0],m=h[2],n=h[3];h=h[4];c("useMWMaybeInboxMediaRestoreLoop")(a);var o=h!=null?h:!0;e[0]!==a.threadType?(h={entrypoint:"media_viewer",threadType:a.threadType},e[0]=a.threadType,e[1]=h):h=e[1];h=c("useMWMediaLoadingQplLogger")(h);if(e[2]!==(m==null?void 0:m.lastLoadedMessageId)){var p;p=(p=d("MAWDbMsg").toMsgId((p=m==null?void 0:m.lastLoadedMessageId)!=null?p:""))!=null?p:void 0;e[2]=m==null?void 0:m.lastLoadedMessageId;e[3]=p}else p=e[3];var q;e[4]===Symbol["for"]("react.memo_cache_sentinel")?(q=c("justknobx")._("3233"),e[4]=q):q=e[4];e[5]!==o||e[6]!==n||e[7]!==h||e[8]!==p||e[9]!==a.threadKey?(q={earliestLoadedMediaMessageId:p,hasMoreBefore:o,mediaGalleryGroup:c("LSThreadMediaGalleryGroup").PHOTOS_AND_VIDEOS,minTimestampMs:n,pageSize:q,qplLogger:h,threadKey:a.threadKey},e[5]=o,e[6]=n,e[7]=h,e[8]=p,e[9]=a.threadKey,e[10]=q):q=e[10];var r=k(q);e[11]!==o||e[12]!==r?(n=function(){o&&r()},e[11]=o,e[12]=r,e[13]=n):n=e[13];p=n;e[14]!==m||e[15]!==o||e[16]!==p||e[17]!==j||e[18]!==h.logLoadMediaCancel||e[19]!==h.logLoadMediaSuccess?(a={attachmentsRange:m,hasMore:o,loadMore:p,logLoadMediaCancel:h.logLoadMediaCancel,logLoadMediaSuccess:h.logLoadMediaSuccess,media:j},e[14]=m,e[15]=o,e[16]=p,e[17]=j,e[18]=h.logLoadMediaCancel,e[19]=h.logLoadMediaSuccess,e[20]=a):a=e[20];q=d("MWSharedAttachmentsSectionHooks").useLoader(a);n=q[1];m=c("useMWV2MediaViewerSecurePreviewUrl_CausesSuspense")();p=c("useMWV2MediaViewerSecurePlayableUrl_CausesSuspense")();h=l;if(b("cr:5970")==null||b("cr:5931")==null){e[21]===Symbol["for"]("react.memo_cache_sentinel")?(a=i.jsx(c("MWV2MediaViewerNullState.react"),{}),e[21]=a):a=e[21];return a}e[22]!==f||e[23]!==p||e[24]!==m||e[25]!==g||e[26]!==j?(q=i.jsx(d("MWChatAttachmentMediaState.react").MWChatAttachmentMediaStateProviderFromAttachments,{attachments:j,getIsSecureThread:h,getPlayableUrl:p,getPreviewUrl:m,initialAttachment:g,children:f}),e[22]=f,e[23]=p,e[24]=m,e[25]=g,e[26]=j,e[27]=q):q=e[27];e[28]!==p||e[29]!==m||e[30]!==n||e[31]!==j||e[32]!==q?(a=i.jsx(d("MWV2MediaViewerContext.react").MWV2MediaViewerContextProvider,{getDownloadUrl:p,getPlayableUrl:p,getPreviewUrl:m,heroLoggingComponent:c("emptyFunction"),loadMore:n,media:j,children:q}),e[28]=p,e[29]=m,e[30]=n,e[31]=j,e[32]=q,e[33]=a):a=e[33];return a}function l(){return!0}g["default"]=e}),98);
__d("MWV2MediaViewer.react",["FBLogger","FocusRegion.react","FocusWithinHandler.react","I64","LSMessagingThreadTypeUtil","MAWThreadCutover","MWFocusTable.react","MWLSThread","MWLSThreadDisplayContext","MWPThreadCapabilitiesContext","MWV2MediaViewerContent.react","MWV2MediaViewerCutoverWrapper.react","MWV2MediaViewerNullState.react","MWV2MediaViewerOpenWrapper.react","MWV2MediaViewerSecureWrapper.react","XPlatReactFocusRegion.react","focusScopeQueries","justknobx","react","react-compiler-runtime","requireDeferred","useMWMediaViewerOpenQPLLogger"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j=h||(h=d("react"));b=h;b.useCallback;var k=b.useEffect,l=b.useId,m=c("requireDeferred")("MAWFTSRestoreSync").__setRef("MWV2MediaViewer.react");function a(a){var b=d("react-compiler-runtime").c(61),e=a.attachment,f=a.onClose;a=a.shouldShowMessengerLogo;var g=d("useMWMediaViewerOpenQPLLogger").useMWMediaViewerOpenQPLLogger(),h=g.endSuccess,n;b[0]!==h?(g=function(){h()},n=[h],b[0]=h,b[1]=g,b[2]=n):(g=b[1],n=b[2]);k(g,n);g=d("MWLSThreadDisplayContext").useMWLSThreadDisplayContext();var o=g==="ChatTab";b[3]!==o?(n=function(){if(!c("justknobx")._("3195"))return;m.onReady(function(a){a=a.getMediaRestoreSync;a=a();o&&(a.setIsStarted(!1),a.setShouldPauseRestore(!0))})},b[3]=o,b[4]=n):n=b[4];var p=n;g=d("MWLSThread").useThread(e.threadKey);n=d("MWPThreadCapabilitiesContext").Provider;var q=l(),r;b[5]!==q?(r=function(a){a||d("FocusRegion.react").focusRegionById(q,d("MWFocusTable.react").tabbableScopeQuery)},b[5]=q,b[6]=r):r=b[6];r=r;var s=d("MAWThreadCutover").useGetCutoverOpenThreadKey(e.threadKey),t=d("MAWThreadCutover").useCutoverSecureThreadKeyForOpenThreadKey(s==null?e.threadKey:void 0);if(g==null){c("FBLogger")("messenger_web_media").mustfix("Thread is null in media viewer for attachment with threadKey: %s",(i||(i=d("I64"))).to_string(e.threadKey));var u;b[7]===Symbol["for"]("react.memo_cache_sentinel")?(u=j.jsx(c("MWV2MediaViewerNullState.react"),{}),b[7]=u):u=b[7];return u}u=d("LSMessagingThreadTypeUtil").isArmadilloSecure(g.threadType);if(s!=null||t!=null){s=s!=null?s:g.threadKey;t=t!=null?t:g.threadKey;var v;b[8]!==f||b[9]!==p?(v=function(){p(),f&&f()},b[8]=f,b[9]=p,b[10]=v):v=b[10];var w;b[11]!==e||b[12]!==a||b[13]!==v||b[14]!==g?(w=j.jsx(c("MWV2MediaViewerContent.react"),{initialAttachment:e,onClose:v,shouldShowMessengerLogo:a,thread:g}),b[11]=e,b[12]=a,b[13]=v,b[14]=g,b[15]=w):w=b[15];b[16]!==e||b[17]!==s||b[18]!==t||b[19]!==w||b[20]!==g.threadType?(v=j.jsx(c("MWV2MediaViewerCutoverWrapper.react"),{initialAttachment:e,openThreadKey:s,secureThreadKey:t,threadType:g.threadType,children:w}),b[16]=e,b[17]=s,b[18]=t,b[19]=w,b[20]=g.threadType,b[21]=v):v=b[21];s=v;b[22]!==s||b[23]!==g?(t=j.jsx(n,{thread:g,children:s}),b[22]=s,b[23]=g,b[24]=t):t=b[24];w=t;b[25]!==w||b[26]!==q?(v=j.jsx(c("XPlatReactFocusRegion.react"),{autoFocusQuery:d("MWFocusTable.react").tabbableScopeQuery,containFocusQuery:d("MWFocusTable.react").tabbableScopeQuery,id:q,recoverFocusQuery:d("focusScopeQueries").headerFirstTabbableSecondScopeQuery,children:w}),b[25]=w,b[26]=q,b[27]=v):v=b[27];s=v;b[28]!==s||b[29]!==r?(t=c("justknobx")._("3588")?j.jsx(c("FocusWithinHandler.react"),{onFocusChange:r,onFocusVisibleChange:r,children:s}):s,b[28]=s,b[29]=r,b[30]=t):t=b[30];return t}if(u){b[31]!==f||b[32]!==p?(w=function(){p(),f&&f()},b[31]=f,b[32]=p,b[33]=w):w=b[33];b[34]!==e||b[35]!==a||b[36]!==w||b[37]!==g?(v=j.jsx(c("MWV2MediaViewerContent.react"),{initialAttachment:e,onClose:w,shouldShowMessengerLogo:a,thread:g}),b[34]=e,b[35]=a,b[36]=w,b[37]=g,b[38]=v):v=b[38];b[39]!==e||b[40]!==v||b[41]!==g?(s=j.jsx(c("MWV2MediaViewerSecureWrapper.react"),{initialAttachment:e,thread:g,children:v}),b[39]=e,b[40]=v,b[41]=g,b[42]=s):s=b[42];t=s;b[43]!==t||b[44]!==g?(u=j.jsx(n,{thread:g,children:t}),b[43]=t,b[44]=g,b[45]=u):u=b[45];w=u;b[46]!==w||b[47]!==q?(v=j.jsx(c("XPlatReactFocusRegion.react"),{autoFocusQuery:d("MWFocusTable.react").tabbableScopeQuery,containFocusQuery:d("MWFocusTable.react").tabbableScopeQuery,id:q,recoverFocusQuery:d("focusScopeQueries").headerFirstTabbableSecondScopeQuery,children:w}),b[46]=w,b[47]=q,b[48]=v):v=b[48];s=v;b[49]!==s||b[50]!==r?(n=c("justknobx")._("3588")?j.jsx(c("FocusWithinHandler.react"),{onFocusChange:r,onFocusVisibleChange:r,children:s}):s,b[49]=s,b[50]=r,b[51]=n):n=b[51];return n}b[52]!==e||b[53]!==f||b[54]!==a||b[55]!==g?(t=j.jsx(c("MWV2MediaViewerContent.react"),{initialAttachment:e,onClose:f,shouldShowMessengerLogo:a,thread:g}),b[52]=e,b[53]=f,b[54]=a,b[55]=g,b[56]=t):t=b[56];b[57]!==e||b[58]!==t||b[59]!==g?(u=j.jsx(c("MWV2MediaViewerOpenWrapper.react"),{initialAttachment:e,thread:g,children:t}),b[57]=e,b[58]=t,b[59]=g,b[60]=u):u=b[60];return u}g["default"]=a}),98);
__d("useMWInboxMediaRestoreLoop",["Int64Hooks","LSMessagingThreadTypeUtil","MAWMiActOnActThreadReadyDeferred","promiseDone","react","react-compiler-runtime","requireDeferred","useAsyncReStore"],(function(a,b,c,d,e,f,g){"use strict";var h;b=h||d("react");b.useCallback;var i=b.useState,j=c("requireDeferred")("MAWFTSRestoreSync").__setRef("useMWInboxMediaRestoreLoop");function a(a){var b=d("react-compiler-runtime").c(14),e=a.threadKey,f=c("useAsyncReStore")(),g=i(null),h=g[0],k=g[1],l;b[0]!==f||b[1]!==h||b[2]!==a.threadType||b[3]!==e?(g=function(){var b=async function(){var a=await f;c("promiseDone")(c("MAWMiActOnActThreadReadyDeferred")(a,e,"mediaRestore",function(a,b){j.onReady(function(a){a=a.getMediaRestoreSync;a().setActiveThreadId(b);c("promiseDone")(a().startMediaSyncingLoop());k(a())});return Promise.resolve()}))};d("LSMessagingThreadTypeUtil").isArmadilloSecure(a.threadType)&&c("promiseDone")(b());return function(){h==null||h.setIsStarted(!1),h==null||h.setShouldPauseRestore(!0)}},l=[f,h,a.threadType,e],b[0]=f,b[1]=h,b[2]=a.threadType,b[3]=e,b[4]=g,b[5]=l):(g=b[4],l=b[5]);d("Int64Hooks").useEffectInt64(g,l);b[6]!==h?(g=function(){h!=null&&(h.resetEBAvailability(),h.isStarted()||c("promiseDone")(h.startMediaSyncingLoop()))},b[6]=h,b[7]=g):g=b[7];var m=g;b[8]!==h?(l=function(){h!=null&&(h.isStarted()||c("promiseDone")(h.startMediaSyncingLoop()))},b[8]=h,b[9]=l):l=b[9];var n=l;b[10]!==m||b[11]!==n?(g=function(){return{onEBOnboarded:m,startMediaSync:n}},l=[m,n],b[10]=m,b[11]=n,b[12]=g,b[13]=l):(g=b[12],l=b[13]);return d("Int64Hooks").useMemoInt64(g,l)}g.default=a}),98);